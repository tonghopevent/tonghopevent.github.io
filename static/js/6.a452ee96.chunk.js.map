{"version":3,"sources":["Theme.js","layouts/Login.jsx","components/NoteEditDialog.jsx","components/Doc.jsx","components/ToolsDialog.jsx","components/DuplicateDocDialog.jsx","DuplicateHelper.js","layouts/Home.jsx","layouts/View.jsx","components/DatePicker.jsx","components/Timeslots.jsx","layouts/Publish.jsx","layouts/GetImage.jsx","components/Alert.jsx","components/FBPostEditDialog.jsx","layouts/fb/PostList.jsx","layouts/fb/Scheduled.jsx","layouts/fb/FBFeed.jsx","layouts/Settings.jsx","components/messenger/socket.js","components/messenger/Context.jsx","components/messenger/Conversations.jsx","components/messenger/Header.jsx","components/messenger/MessageInput.jsx","components/messenger/MessageView.jsx","components/messenger/Messenger.jsx","components/messenger/index.js","components/sidebar/styles.js","components/sidebar/SidebarItems.js","components/sidebar/Sidebar.jsx","components/Measure.jsx","App.jsx"],"names":["createMuiTheme","palette","primary","main","blueGrey","secondary","error","orange","Login","React","Component","constructor","props","super","handleChange","name","event","this","setState","target","value","state","window","changeHeader","username","password","showAlert","title","text","loading","res","axios","post","Config","BACKEND","data","token","Utils","setLocalStorage","location","href","render","classes","input","marginBottom","width","maxWidth","container","display","flexWrap","cardStyle","marginTop","marginRight","marginLeft","CircularProgress","form","Card","style","CardContent","Typography","variant","component","color","TextField","label","type","onChange","margin","Button","onClick","onLogin","bind","NoteEditDialog","comment","doc","onClose","Fragment","Dialog","fullWidth","open","DialogTitle","id","DialogContent","DialogContentText","multiline","rowsMax","DialogActions","Doc","getImageUrl","image","length","startsWith","isNoteEditOpen","isCopied","isExpanded","admin","copyContent","getCopyContent","linkfb","fbusername","extractFacebookUsername","publishAction","field","val","url","success","newDoc","JSON","parse","stringify","setDoc","i","trashed","getLocalStorage","updateDocField","approved","cmt","generateLocationTag","join","description","trim","cleanFBLink","wanted","deadline","benefit","psid","locations","console","log","addLoc","loc","push","replace","forEach","_renderNonAdminInfo","backgroundColor","padding","_renderDuplicatedWarningIcon","duplicateHelper","openDuplicateDocDialog","duplicatedDocs","checkDoc","Fab","size","_renderPostContent","nl2br","rel","getTimeStr","created","getDateStr","org","getOrgName","feedback","_renderMainCard","gotoPublish","content","maxHeight","overflow","position","className","disabled","plan","toUpperCase","componentDecorator","key","Divider","toggleTrashDoc","toggleApproved","caption","openToolsDialog","paddingBottom","updateComment","_renderTrashedDoc","TEMPLATES","desc","ToolsDialog","showTemplates","sendInboxData","inboxData","isLinkCopied","response","makeRequest","Object","keys","obj","closeToolsDialog","message","toastr","goToPageInbox","goToInbox","_renderSendInboxDialogAsk","isWithin24HWindow","Date","now","handleClose","copyTextToClipboard","sendInbox","_renderError","List","ListItem","button","ListItemText","_renderContent","senders","map","t","protocol","host","onCopy","onEnter","fetchData","onBackdropClick","substr","DuplicateDocDialog","docs","selectedDocID","daysAgo","Math","floor","closeDuplicateDocDialog","DuplicateHelper","seen","pushLookbackData","lookbackArr","fbname","pushDoc","uname","arr","clear","Home","markDocApproved","DOCID_APPROVED","dispatchDocApproved","prevState","list","toolsDialogOpen","toolsDialogDoc","duplicateDocDialog","componentDidMount","loadData","componentWillUnmount","getToken","Promise","all","get","checkError","onClickEdit","edit","docid","home","columnsCountBreakPoints","gutter","View","_renderDocView","_renderDocNotFound","MaterialUIPickers","publish_time","handleDateChange","getTime","date","utils","DateFnsUtils","KeyboardButtonProps","ONE_DAY_IN_MS","INTERVAL_BETWEEN_POSTS_IN_MS","FIX_TIME_OFFSET","SLOTS","hrs","min","priority","s","timeInDay","getDayFromFeedback","matched","match","d","parseInt","setTime","getTimezoneOffset","ScheduledList","stat","statAsc","sort","getDayLabel","beginOfTodayLocal","TimeslotPicker","statArr","useOldPicker","setUseOldPicker","useState","showMoreSlots","setShowMoreSlots","timeslots","beginOfTodayGMT","day","slotsOfDay","time","startAt","generateTimeslots","takenSlots","setTakenSlots","suggestedSlot","setSuggestedSlot","useEffect","some","scheduledTime","getTakenSlotList","suggested","_timeslots","userSuggestedTime","slots","entries","a","b","getSuggestedSlot","setTimeout","round","DatePicker","Publish","getErrorMessage","completed","scheduled_publish_time","loadStat","loadInbox","idInDatabase","postData","toast","info","timeOut","hash","_renderComposerCard","imgStyle","height","alt","src","loader","_renderPublishCard","isDateOK","onClickOK","doPublish","showCancel","_renderCompletedCard","_renderInboxCard","messages","msg","from","_renderMain","imgLoaderStyle","GetImage","showGetToken","access_token","imgs","fetchFacebookApi","fbtoken","feed","full_picture","unshift","picture","e","status","onSaveToken","urlNow","alert","_renderTitleCard","_renderImageCard","float","_data","_renderGetTokenCard","Alert","handleClickOK","handleCancel","show","autoFocus","FBPostEditDialog","onEditPost","async","patch","editPostEndpoint","split","ImgLoader","PostList","processTimeField","timeFieldName","p","created_time","deletePost","confirm","delete","deletePostEndpoint","openOnFB","focus","onEditDialogClose","shouldReload","editingPost","posts","newestFirst","loadFeedEndpoint","reverse","_renderMainView","isFromUser","SELF_PAGE_ID","fontWeight","children","expanded","substring","preventDefault","j","cloned","loadingComponent","Scheduled","FBFeed","Settings","settings","saveSettings","setSettings","markReadOnOpenInbox","FormControlLabel","control","Switch","checked","Socket","SOCKETIO","socket","io","transports","query","SOCKETIO_MODULE","on","handler","getSocket","offAny","uuidv4","c","crypto","getRandomValues","Uint8Array","toString","method","endpoint","body","resolve","PROD","requestId","callback","emit","toLowerCase","MessengerContext","createContext","MessengerContextProvider","unreadMark","fetchUnread","markUnread","markRead","INBOX_UNREAD_ABILITY","Provider","withMessengerContext","Consumer","contexts","Conversations","ready","conversations","next","openConversation","n","removeVietnameseTones","inboxUpdateHandler","newArr","limit","mergeNewConversations","onYReachEnd","loadMoreConversations","subscribeInbox","unsubscribeInbox","qs","after","paging","filter","INBOX_IGNORED_CONVERSATION","cursors","loadingMore","conv","getTargetId","message_count","snippet","active","tid","unreadDot","MarkButton","icon","faEnvelopeOpenText","faEnvelope","Header","profile","openConversationOnFB","openMainMenu","Back","Content","userName","profile_pic","Actions","as","noop","EditorContainer","Container","fancyScroll","forwardedRef","rest","ref","forwardRef","editorContainer","useControllableState","initialValue","initial","stateValue","setStateValue","newValue","MessageInputInner","onSend","placeholder","activateAfterChange","sendDisabled","sendOnReturnDisabled","attachDisabled","sendButton","attachButton","onAttachClick","scrollRef","useRef","msgRef","stateSendDisabled","setStateSendDisabled","current","useImperativeHandle","updateScroll","send","cName","ph","classNames","onKeyPress","evt","shiftKey","ev","maxRows","minRows","MessageInput","displayName","propTypes","PropTypes","string","bool","func","defaultProps","undefined","TimeAgo","addLocale","en","timeAgo","MessageView","threadInfo","messageAfter","messagePending","messagePendingId","originalTitle","document","newMessages","mergeNewMessages","mid","onYReachStart","concat","link","openInNewTab","goBackTo","handleSendMessage","message_id","makeRequestSendAPI","messaging_type","tag","recipient","fetchConversation","setMessageInput","componentDidUpdate","prevProps","INBOX_MARK_READ_ON_OPEN","INBOX_TITLE","_renderMessages","lastDirection","showTimeHeader","direction","getMessageDirection","Footer","sender","format","showImages","images","img","model","CustomContent","preview_url","attachments","image_data","getImages","sentTime","showTextMsg","INBOX_SEND_ABILITY","opacity","_renderInput","txt","openTemplateDialog","Messenger","viewHeight","updateHeight","NUI_VIEW_HEIGHT","scrollable","CustomMessengerWidget","MessageTidChanged","params","MessageTidReset","intervalId","setInterval","clearInterval","path","exact","withRouter","drawerWidth","useSidebarStyles","makeStyles","theme","root","appBar","zIndex","drawer","transition","transitions","create","easing","sharp","duration","leavingScreen","appBarShift","enteringScreen","menuButton","hide","flexShrink","whiteSpace","drawerOpen","drawerClose","overflowX","breakpoints","up","spacing","toolbar","alignItems","justifyContent","mixins","flexGrow","SidebarItems","separator","hidden","pathname","useTheme","setOpen","currentMenuItem","currentHash","item","getCurrentMenuItem","isPublicView","handleClickItem","CssBaseline","AppBar","Toolbar","IconButton","edge","noWrap","Drawer","paper","selected","ListItemIcon","Measure","elem","div","clientHeight","NUI_VIEW_WIDTH","clientWidth","top","left","pointerEvents","Main","publishData","Copyright","VERSION","Logout","removeLocalStorage","reload","header","LoginLayout","RedirectToHome","App","Theme"],"mappings":"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","file":"static/js/6.a452ee96.chunk.js","sourcesContent":["import { createMuiTheme } from '@material-ui/core/styles';\r\nimport blueGrey from '@material-ui/core/colors/blueGrey';\r\nimport orange from '@material-ui/core/colors/orange';\r\n\r\nexport default createMuiTheme({\r\n  palette: {\r\n    primary: { main: blueGrey[700] },\r\n    secondary: { main: blueGrey[200] },\r\n    error: { main: orange[900] }\r\n  }\r\n})","import React from 'react'\n\nimport Card from '@material-ui/core/Card'\nimport Typography from '@material-ui/core/Typography'\nimport CardContent from '@material-ui/core/CardContent'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport axios from 'axios'\nimport Config from '../Config'\nimport Utils from '../Utils'\n\nclass Login extends React.Component {\n  constructor(props) {\n    super()\n    this.props = props\n    this.state = {}\n    window.changeHeader('Login')\n  }\n\n  handleChange = name => event => {\n    this.setState({ [name]: event.target.value })\n  }\n\n  async onLogin() {\n    if (this.state.username === '' || this.state.password === '') {\n      return window.showAlert({\n        title: 'Please fill in',\n        text: 'Please fill in your username and password'\n      })\n    } else {\n      this.setState({loading: true})\n      const {username, password} = this.state\n      const res = await axios.post(`${Config.BACKEND}/login`, {\n        username, password\n      })\n      this.setState({loading: false})\n      if (res.data.token) {\n        Utils.setLocalStorage('token', res.data.token)\n        window.location.href = '#/'\n      } else {\n        return window.showAlert({\n          title: 'Error',\n          text: res.data.error\n        })\n      }\n    }\n  }\n\n  async onRegister() {}\n\n  render() {\n    var classes = {\n      input: {\n        marginBottom: '20px',\n        width: '500px',\n        maxWidth: '100%'\n      },\n      container: {\n        display: 'flex',\n        flexWrap: 'wrap',\n      },\n      cardStyle: {\n        maxWidth: '500px',\n        marginTop: '20px',\n        marginRight: 'auto',\n        marginLeft: 'auto',\n      }\n    }\n\n    const loading = <div>\n      <br/><br/><br/>\n      <center><CircularProgress /></center>\n    </div>\n\n    const form = (\n      <div>\n        <Card style={classes.cardStyle}>\n          <CardContent>\n            <Typography variant=\"h5\" component=\"h2\">Admin - TongHopEvent</Typography>\n            <Typography color=\"textSecondary\">Please login to continue</Typography>\n            <TextField\n              label=\"Username\"\n              type=\"text\"\n              value={this.state.username}\n              style={classes.input}\n              onChange={this.handleChange('username')}\n              margin=\"normal\"\n            />\n            <TextField\n              label=\"Password\"\n              type=\"password\"\n              value={this.state.password}\n              style={classes.input}\n              onChange={this.handleChange('password')}\n              margin=\"normal\"\n            />\n            <div>\n              <Button onClick={this.onLogin.bind(this)} color='primary'>Login</Button>\n            </div>\n          </CardContent>        \n        </Card>\n      </div>\n    )\n\n    return this.state.loading ? loading : form\n  }\n}\n\nexport default Login","import React from 'react'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogContentText from '@material-ui/core/DialogContentText'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport PropTypes from 'prop-types'\n\nclass NoteEditDialog extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      comment: props.doc.comment || '',\n    }\n  }\n\n  static propTypes = {\n    onClose: PropTypes.func.isRequired,\n    doc: PropTypes.any.isRequired,\n  }\n\n  render() {\n    const { comment } = this.state\n    const { onClose } = this.props\n\n    return (\n      <React.Fragment>\n        <Dialog fullWidth={true} open={true} onClose={() => onClose(false)} aria-labelledby=\"form-dialog-title\">\n          <DialogTitle id=\"form-dialog-title\">Ghi ch</DialogTitle>\n          <DialogContent>\n            <DialogContentText>\n              Bn c th  li ghi ch cho bi vit ny. Ch c Admin mi nhn thy ghi ch.\n            </DialogContentText>\n            <TextField\n              multiline\n              rowsMax=\"20\"\n              value={comment}\n              onChange={event => {this.setState({ comment: event.target.value })}}\n              margin=\"normal\"\n              variant=\"outlined\"\n              fullWidth\n            />\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={() => onClose(false)} color=\"primary\">\n              Quay li\n            </Button>\n            <Button onClick={() => onClose(comment)} color=\"primary\">\n              LU GHI CH\n            </Button>\n          </DialogActions>\n        </Dialog>\n      </React.Fragment>\n    )\n  }\n}\n\nexport default NoteEditDialog\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport axios from 'axios'\nimport Config from '../Config'\nimport Utils from '../Utils'\nimport Card from '@material-ui/core/Card'\nimport CardContent from '@material-ui/core/CardContent'\nimport Button from '@material-ui/core/Button'\nimport Linkify from 'react-linkify'\nimport Fab from '@material-ui/core/Fab'\nimport Divider from '@material-ui/core/Divider'\nimport CheckIcon from '@material-ui/icons/Check'\nimport WarningIcon from '@material-ui/icons/Warning'\nimport NoteEditDialog from './NoteEditDialog'\nimport './Doc.css'\n\nclass Doc extends React.Component {\n  constructor(props) {\n    super()\n    this.props = props\n    this.state = {\n      loading: false,\n      isNoteEditOpen: false,\n      isCopied: false,\n      isExpanded: !this.props.admin,\n      copyContent: this.props.admin ? this.getCopyContent() : '',\n    }\n\n    if (this.props.doc && this.props.doc.linkfb) {\n      this.fbusername = Utils.extractFacebookUsername(this.props.doc.linkfb)\n    }\n\n    if (props.admin) {\n      if (props.doc.image)\n        this.state.publishAction = 'publish'\n      else if (this.fbusername)\n        this.state.publishAction = 'getimage'\n      else\n        this.state.publishAction = null\n    }\n  }\n\n  static propTypes = {\n    doc: PropTypes.object.isRequired,\n  }\n\n  async updateDocField(field, val, url, data) {\n    this.setState({loading: true})\n    const {doc} = this.props\n    const res = await axios.post(url, data)\n    if (res.data.success) {\n      const newDoc = JSON.parse(JSON.stringify(doc))\n      newDoc[field] = val\n      this.props.setDoc(this.props.i, newDoc)\n    } else {\n      window.showAlert({\n        title: 'Error',\n        text: res.data.error\n      })\n    }\n    this.setState({loading: false})\n  }\n\n  async toggleTrashDoc() {\n    const { doc } = this.props\n    const trashed = !doc.trashed\n    const token = Utils.getLocalStorage('token')\n    await this.updateDocField(\n      'trashed', trashed,\n      `${Config.BACKEND}/doc/${doc.id}/trashed?token=${token}`, {trashed}\n    )\n  }\n\n  async toggleApproved() {\n    const {doc} = this.props\n    const approved = !doc.approved\n    const token = Utils.getLocalStorage('token')\n    await this.updateDocField(\n      'approved', approved,\n      `${Config.BACKEND}/doc/${doc.id}/approved?token=${token}`, {approved}\n    )\n  }\n\n  async updateComment(cmt) {\n    const {doc} = this.props\n    const token = Utils.getLocalStorage('token')\n    await this.updateDocField(\n      'comment', cmt || '',\n      `${Config.BACKEND}/doc/${doc.id}/comment?token=${token}`, {comment: cmt}\n    )\n  }\n\n  getCopyContent() {\n    const { doc } = this.props\n\n    const content = `-- ${doc.name} --\\n` +\n    `${this.generateLocationTag(doc)} ${doc.type.join(' ')}\\n\\n` +\n    ` M t: ${doc.description.trim()}\\n\\n` +\n    ` Link facebook: ${Utils.cleanFBLink(doc.linkfb)}\\n` +\n    ((doc.wanted && doc.wanted.length > 0) ? ' Yu cu i tng: ' + doc.wanted.join(', ').trim() + '\\n' : '') + \n    (!!doc.deadline ? ' Deadline tuyn nhn s: ' + doc.deadline.trim() + '\\n' : '') +\n    (!!doc.benefit ? ' Quyn li khi tham gia d n:\\n' + doc.benefit.trim() + '\\n' : '') +\n    `\\nTrackID:${doc.psid}:${doc.id}`\n\n    return content.trim()\n  }\n\n  generateLocationTag(doc) {\n    const { location, locations } = doc\n    const res = []\n    console.log(doc)\n    const addLoc = (loc) => {\n      res.push(loc === 'Ton quc'\n        ? `#d_n_ton_quc`\n        : `#d_n__${loc.replace(/\\s+/g, '_')}`\n      )\n    }\n    if (location) addLoc(location)\n    if (locations) locations.forEach(addLoc)\n    return res.join(' ')\n  }\n\n  getImageUrl = () => {\n    const { doc: { image } } = this.props\n    if (!image || image.length === 0) return null\n    return image[0].startsWith('http')\n      ? image[0] // normal image URL\n      : `https://drive.google.com/uc?export=view&id=${image[0]}`\n  }\n\n  _renderNonAdminInfo() {\n    const { doc } = this.props\n    return <p style={{\n      backgroundColor: doc.trashed ? '#ffa3a3' : '#eee',\n      padding: '10px',\n      width: '100%'}}\n    >\n      <center>\n        {doc.trashed ? 'Bi vit ny  b t chi'\n          : (doc.approved\n            ? 'Bi vit ny  c duyt v s sm c ng ln fanpage'\n            : 'Bi vit ny ang i  c kim duyt')\n        }\n      </center>\n    </p>\n  }\n\n  _renderDuplicatedWarningIcon() {\n    const { doc, duplicateHelper, openDuplicateDocDialog } = this.props\n    if (!duplicateHelper || doc.approved) return null\n    const duplicatedDocs = duplicateHelper.checkDoc(doc)\n    if (!duplicatedDocs) return null\n    else return (\n      <Fab\n        size=\"small\"\n        color=\"primary\"\n        style={{marginRight: '15px'}}\n        onClick={() => openDuplicateDocDialog(duplicatedDocs, doc.id)}\n      >\n        <WarningIcon />\n      </Fab>\n    )\n  }\n\n  _renderPostContent() {\n    const { doc } = this.props\n    return (\n      <React.Fragment>\n        <p>{this.generateLocationTag(doc)} {doc.type.join(' ')}</p>\n        <p>{Utils.nl2br(doc.description)}</p>\n        <p>\n           Link facebook: {Utils.cleanFBLink(doc.linkfb)}<br/>\n          {(doc.wanted && doc.wanted.length > 0) && <span> Yu cu i tng: {doc.wanted.join(', ')}<br/></span>}\n          {!!doc.deadline && <span> Deadline tuyn nhn s: {Utils.nl2br(doc.deadline)}<br/></span>}\n          {!!doc.benefit && <span> Quyn li khi tham gia d n: <br/>{Utils.nl2br(doc.benefit)}<br/></span>}\n        </p>\n        {this.props.admin && <p>TrackID:{doc.psid}:{doc.id}</p>}\n        {!!doc.image && <p>\n          nh tu chn: <a href={this.getImageUrl()} target=\"_blank\" rel=\"noopener noreferrer\">Bm vo y</a>\n        </p>}\n        <p>\n          (Gi lc {Utils.getTimeStr(doc.created)} ngy {Utils.getDateStr(doc.created)})\n          {!!doc.org && <span><br/>n v t chc: {Utils.getOrgName(doc)}</span>}\n        </p>\n        {(!this.props.admin && !!doc.feedback) && <p> Cu hi, gp : {doc.feedback}</p>}\n      </React.Fragment>\n    )\n  }\n\n  _renderMainCard() {\n    const { doc } = this.props\n    const { isExpanded, copyContent, publishAction, isNoteEditOpen } = this.state\n    const gotoPublish = this.props.gotoPublish || (() => {})\n\n    const componentDecorator = (href, text, key) => (\n      <a href={href} key={key} target=\"_blank\" rel=\"noopener noreferrer\">\n        {text}\n      </a>\n    )\n\n    /* TEXT CONTENT (visible for all) */\n\n    const content = <div>\n      <div style={isExpanded ? null : {maxHeight: '315px', overflow:'hidden', position: 'relative'}} className={isExpanded ? null : 'fade-out'}>\n        {!this.props.admin && this._renderNonAdminInfo()}\n        <p>\n          {doc.approved && <Fab size=\"small\" color=\"primary\" style={{marginRight: '15px'}} disabled>\n            <CheckIcon />\n          </Fab>}\n          {this._renderDuplicatedWarningIcon()}\n          <b>-- {doc.name} --</b>\n          {doc.plan && <p><span className='doc-plan'> Gi {doc.plan.toUpperCase()}</span></p>}\n        </p>\n        <Linkify componentDecorator={componentDecorator}>\n          {this._renderPostContent()}\n        </Linkify>\n      </div>\n      {this.props.admin && <div>\n        <center>\n          <Button onClick={() => this.setState({isExpanded: !isExpanded})}>\n            {isExpanded ? 'Thu gn' : 'Hin thm ...'}\n          </Button>\n        </center>\n      </div>}\n      <Divider />\n\n      {/* ADMIN BUTTONS */}\n\n      {this.props.admin &&\n        <React.Fragment>\n          {!this.state.loading ? <div>\n            {doc.comment && doc.comment.trim().length > 0 && <p><b> Ghi ch:</b> {Utils.nl2br(doc.comment)}</p>}\n            {!!doc.feedback && <p> Cu hi, gp : {doc.feedback}</p>}\n            <Button variant=\"outlined\" onClick={this.toggleTrashDoc.bind(this)} color='primary'>Xa</Button>\n            <Button variant=\"outlined\" onClick={this.toggleApproved.bind(this)} color='primary'>Tick</Button>\n            {publishAction &&\n              <Button variant=\"outlined\" onClick={() => {gotoPublish({\n                id: doc.id,\n                caption: copyContent,\n                url: this.getImageUrl(),\n                fbusername: this.fbusername,\n                psid: doc.psid,\n                feedback: doc.feedback,\n              }, publishAction)}} color='primary'>ng bi</Button>\n            }\n            <Button variant=\"outlined\" onClick={() => this.setState({isNoteEditOpen: true})} color='primary'>Ghi ch</Button>\n            <Button variant=\"outlined\" onClick={() => this.props.openToolsDialog(doc)} color='primary'>+</Button>\n          </div>\n          : <center>\n            <CircularProgress />\n          </center>}\n        </React.Fragment>\n      }\n    </div>\n\n    /* CARD BACKGROUND */\n\n    return (\n      <div style={{paddingBottom: '20px'}}>\n        <Card>\n          <CardContent\n            style={{backgroundColor: (doc.approved && this.props.admin) ? '#cfd8dc' : '#fff'}}\n            className={(doc.approved && this.props.admin) ? 'approved' : null}\n          >\n            {content}\n          </CardContent>\n        </Card>\n        {isNoteEditOpen && <NoteEditDialog doc={doc} onClose={(cmt) => {\n          this.setState({isNoteEditOpen: false})\n          if (cmt !== false) this.updateComment(cmt)\n        }}/>}\n      </div>\n    )\n  }\n\n  _renderTrashedDoc() {\n    const { doc } = this.props\n    if (this.state.loading) return <center><CircularProgress /></center>\n    else return <p>\n      <b>( xa)</b> {doc.name} &nbsp;&nbsp;&nbsp;\n      <Button\n        variant=\"outlined\"\n        size=\"small\"\n        color=\"primary\"\n        className=\"restore-btn\"\n        onClick={this.toggleTrashDoc.bind(this)}\n      >\n        Khi phc\n      </Button>\n    </p>\n  }\n\n  render() {\n    const { doc, admin } = this.props\n    return doc.trashed && admin\n      ? this._renderTrashedDoc()\n      : this._renderMainCard()\n  }\n}\n\nexport default Doc","import React from 'react'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogContentText from '@material-ui/core/DialogContentText'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport Button from '@material-ui/core/Button'\nimport Divider from '@material-ui/core/Divider'\nimport TextField from '@material-ui/core/TextField'\nimport Utils from '../Utils'\nimport Config from '../Config'\nimport PropTypes from 'prop-types'\nimport { CopyToClipboard } from 'react-copy-to-clipboard'\nimport './ToolsDialog.css'\n\nconst copyObj = (obj) => JSON.parse(JSON.stringify(obj))\n\nconst TEMPLATES = [\n  {\n    desc: 'Bo trng bi',\n    text: ' c ngi nhp thng tin ca d n / cuc thi / s kin ny. Khng bit bn c mun b sung hay thay i g khng nh?\\n\\nNu khng, chng mnh s xa thng tin bn  nhp  khng b trng vi bi  ng.'\n  },{\n    desc: 'Bo b xa v ko ph hp',\n    text: 'Xin cho bn,\\n\\nD n / cuc thi / s kin ca bn  b xa do khng ph hp vi iu khon s dng ca chng mnh.\\n\\nHy tham kho iu khon s dng ca fanpage ti y: https://sites.google.com/view/tonghopevent'\n  }, {\n    desc: 'Bo d n c li nhun',\n    text: 'Xin cho bn,\\n\\nD n / cuc thi / s kin ca bn c iu hnh bi mt t chc / c nhn hot ng c li nhun. Da theo iu khon s dng ca chng mnh, bi ca bn phi tr ph 100.000 VN  c th c ng bi ln fanpage nh.\\n\\nHy tham kho iu khon s dng ca fanpage ti y: https://sites.google.com/view/tonghopevent'\n  },\n  {\n    desc: 'Bo thiu thng tin',\n    text: 'Admin  xem bi vit ca bn. Tuy nhin, do bi vit ca bn cn thiu mt s thng tin nn chng mnh cha th ph duyt c. Bn hy in li form vi y  thng tin hn nh!\\n\\nHy tham kho v d sau: https://bit.ly/2TZKbee'\n  },\n  {\n    desc: 'in li (khng paste link)',\n    text: 'Admin  xem bi vit ca bn. Tuy nhin, chng mnh khng th x l nu bn ch copy-paste mi link bi vit. Bn hy in li form tht r rng, bao gm c phn gii thiu,  ngha d n / cuc thi / s kin nh.\\n\\nHy tham kho v d sau: https://bit.ly/2TZKbee'\n  },\n]\n\nclass ToolsDialog extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      loading: true,\n      error: false,\n      showTemplates: true,\n      sendInboxData: null,\n      inboxData: {},\n      isLinkCopied: false,\n    }\n  }\n\n  static propTypes = {\n    open: PropTypes.bool.isRequired,\n    closeToolsDialog: PropTypes.func.isRequired,\n    name: PropTypes.string,\n    psid: PropTypes.string,\n    doc: PropTypes.any.isRequired,\n  }\n\n  async fetchData() {\n    this.setState({ error: false, loading: true, showTemplates: true, isLinkCopied: false })\n    const response = await Utils.makeRequest(\n      `${Config.BACKEND}/inbox/${this.props.psid}`\n    )\n    const { data } = response\n    if (data && Object.keys(data).length > 0) {\n      this.setState({\n        loading: false,\n        error: false,\n        inboxData: data,\n      })\n    } else {\n      this.setState({\n        loading: false,\n        error: true,\n      })\n    }\n  }\n\n  async sendInbox() {\n    const inboxData = copyObj(this.state.sendInboxData)\n    this.setState({sendInboxData: null})\n    this.props.closeToolsDialog()\n    const res = await Utils.makeRequest(\n      `${Config.BACKEND}/inbox/${this.props.psid}`,\n      'post', { message: ' ' + inboxData.text }\n    )\n    if (res.data && res.data.success) {\n      window.toastr.success(' gi tin nhn thnh cng!')\n    } else {\n      window.toastr.error(' C li xy ra, ko th gi tin nhn ')\n    }\n  }\n\n  goToPageInbox() {\n    Utils.goToInbox(this.state.inboxData);\n    this.props.closeToolsDialog();\n  }\n\n  _renderSendInboxDialogAsk() {\n    const { sendInboxData } = this.state;\n    const isWithin24HWindow = (Date.now() - this.props.doc.created) < (86400 * 1000)\n    const handleClose = () => this.setState({sendInboxData: null});\n    if (!sendInboxData) return null;\n    else return <Dialog open={!!sendInboxData} onClose={handleClose}>\n      <DialogTitle id=\"alert-dialog-title\">{sendInboxData.desc}</DialogTitle>\n      <DialogContent>\n        <DialogContentText id=\"alert-dialog-description\">\n          {\n            isWithin24HWindow\n             ? 'Gi tin nhn c ni dung nh sau (c th sa):'\n             : 'Khng th t ng gi tin nhn. Hy copy-paste v inbox th cng:'\n          }<br/><br/>\n          <TextField\n            multiline\n            rowsMax=\"20\"\n            value={sendInboxData.text}\n            onChange={event => {this.setState({\n              sendInboxData: {\n                ...sendInboxData,\n                text: event.target.value,\n              }\n            })}}\n            margin=\"normal\"\n            variant=\"outlined\"\n            fullWidth\n          />\n        </DialogContentText>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleClose} color=\"primary\"> Quay li </Button>\n        {!isWithin24HWindow\n          && <Button onClick={() => Utils.copyTextToClipboard(sendInboxData.text)} color=\"primary\"> Copy tin nhn </Button>\n        }\n        {isWithin24HWindow\n          ? <Button onClick={() => this.sendInbox()} color=\"primary\"> GI </Button>\n          : <Button onClick={() => this.goToPageInbox()} color=\"primary\"> i ti inbox </Button>\n        }\n      </DialogActions>\n    </Dialog>\n  }\n\n  _renderError() {\n    return (\n      <List>\n        <ListItem button>\n          <ListItemText primary=\"(C li xy ra)\" />\n        </ListItem>\n        <ListItem button onClick={this.props.closeToolsDialog}>\n          <ListItemText primary=\"Quay li\" />\n        </ListItem>\n      </List>\n    )\n  }\n\n  _renderContent() {\n    const { inboxData, showTemplates, isLinkCopied } = this.state\n\n    return (\n      <List>\n        <ListItem button onClick={this.goToPageInbox.bind(this)}>\n          <ListItemText\n            primary=\"i ti inbox\"\n            secondary={`Tn FB: ${inboxData.senders.data[0].name}`}\n          />\n        </ListItem>\n        <Divider />\n        {!showTemplates && <ListItem button onClick={() => this.setState({showTemplates: true})}>\n          <ListItemText primary={` (Hin cc mu tin nhn)`} />\n        </ListItem>}\n        {showTemplates && TEMPLATES.map((t, i) => {\n          return <ListItem button onClick={() => this.setState({ sendInboxData: t })} key={i}>\n            <ListItemText primary={` ${t.desc}`} />\n          </ListItem>\n        })}\n        <Divider />\n          <CopyToClipboard\n            text={`${window.location.protocol}//${window.location.host}/data/#/view/${this.props.doc.id}`}\n            onCopy={() => this.setState({isLinkCopied: true})}\n          >\n            <ListItem button>\n              <ListItemText primary={isLinkCopied ? \"( copy link)\" : \"Copy link bi vit\"} />\n            </ListItem>\n          </CopyToClipboard>\n        <Divider />\n        <ListItem button onClick={this.props.closeToolsDialog}>\n          <ListItemText primary=\"Quay li\" />\n        </ListItem>\n      </List>\n    )\n  }\n\n  render() {\n    const { name, open } = this.props\n\n    return (\n      <React.Fragment>\n        {this._renderSendInboxDialogAsk()}\n        <Dialog\n          open={open}\n          onEnter={this.fetchData.bind(this)}\n          onBackdropClick={this.props.closeToolsDialog}\n          className=\"tools-dialog\"\n          aria-labelledby=\"simple-dialog-title\"\n        >\n          <DialogTitle id=\"simple-dialog-title\">{name ? name.substr(0,24) : ''}</DialogTitle>\n          {this.state.loading\n            ? <center><CircularProgress /></center>\n            : this.state.error ? this._renderError() : this._renderContent()\n          }\n        </Dialog>\n      </React.Fragment>\n    )\n  }\n}\n\nexport default ToolsDialog\n","import React from 'react'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport Divider from '@material-ui/core/Divider'\nimport PropTypes from 'prop-types'\nimport Utils from '../Utils'\n\nclass DuplicateDocDialog extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {}\n  }\n\n  static propTypes = {\n    docs: PropTypes.any,\n    selectedDocID: PropTypes.any,\n    closeDuplicateDocDialog: PropTypes.func.isRequired,\n  }\n\n  _renderContent() {\n    const { docs, selectedDocID } = this.props\n    const now = Date.now()\n\n    return (\n      <List>\n        {docs.map((doc) => {\n          if (doc.id === selectedDocID) return null\n          const daysAgo = Math.floor((now - doc.created) / 86400 / 1000)\n          return <ListItem button onClick={\n            () => window.open(`/data/#/view/${doc.id}`, '_blank')\n          } key={doc.id}>\n            <ListItemText\n              primary={doc.name}\n              secondary={`${\n                Utils.getDateStr(doc.created)\n              } lc ${\n                Utils.getTimeStr(doc.created)\n              } ${daysAgo > 0 ? ` (${daysAgo} ngy trc)` : ''}`}\n            />\n          </ListItem>\n        })}\n        <Divider />\n        <ListItem button onClick={this.props.closeDuplicateDocDialog}>\n          <ListItemText primary=\"Quay li\" />\n        </ListItem>\n      </List>\n    )\n  }\n\n  render() {\n    const { docs } = this.props\n\n    return (\n      <Dialog\n        open={!!docs}\n        aria-labelledby=\"simple-dialog-title\"\n      >\n        <DialogTitle id=\"simple-dialog-title\">Bi ng trng</DialogTitle>\n        <DialogContent>\n          Bi ng ny c th b trng vi nhng bi sau:\n        </DialogContent>\n        {docs && this._renderContent()}\n      </Dialog>\n    )\n  }\n}\n\nexport default DuplicateDocDialog\n","\r\nimport Utils from './Utils'\r\n\r\nclass DuplicateHelper {\r\n  seen = {}\r\n\r\n  pushLookbackData(lookbackArr) {\r\n    for (const doc of lookbackArr) {\r\n      const { fbname } = doc;\r\n      if (this.seen[fbname]) {\r\n        this.seen[fbname].push(doc)\r\n      } else {\r\n        this.seen[fbname] = [doc]\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remember that we've seen this doc\r\n   * @param {*} doc \r\n   */\r\n  pushDoc(doc) {\r\n    const uname = Utils.extractFacebookUsername(doc.linkfb)\r\n    if (!uname) return null\r\n    if (this.seen[uname]) {\r\n      this.seen[uname].push(doc)\r\n    } else {\r\n      this.seen[uname] = [doc]\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns arr of docs if doc is seen\r\n   * Returns null if doc isn't seen\r\n   * @param {*} doc \r\n   */\r\n  checkDoc(doc) {\r\n    const uname = Utils.extractFacebookUsername(doc.linkfb)\r\n    const arr = this.seen[uname]\r\n    return (arr && arr.length > 1) ? arr : null\r\n  }\r\n\r\n  /**\r\n   * Clear all remembered docs\r\n   */\r\n  clear() {\r\n    this.seen = {}\r\n  }\r\n}\r\n\r\nexport default DuplicateHelper","import React from 'react'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport axios from 'axios'\nimport Config from '../Config'\nimport Utils from '../Utils'\nimport Doc from '../components/Doc'\nimport ToolsDialog from '../components/ToolsDialog'\nimport DuplicateDocDialog from '../components/DuplicateDocDialog'\nimport DuplicateHelper from '../DuplicateHelper'\nimport Masonry, {ResponsiveMasonry} from 'react-responsive-masonry'\n\nclass Home extends React.Component {\n  constructor(props) {\n    super()\n    this.props = props\n    this.state = {\n      loading: true,\n      list: [],\n      toolsDialogOpen: false,\n      toolsDialogDoc: {},\n      duplicateHelper: new DuplicateHelper(),\n      duplicateDocDialog: null,\n      selectedDocID: '',\n    }\n    window.changeHeader('Qun l d liu - TongHopEvent')\n  }\n\n  componentDidMount() {\n    this.loadData()\n    window.markDocApproved = this.markDocApproved\n  }\n\n  componentWillUnmount() {\n    window.markDocApproved = null\n  }\n\n  markDocApproved = (id) => {\n    if (!window.DOCID_APPROVED) window.DOCID_APPROVED = {}\n    window.DOCID_APPROVED[id] = true\n    this.dispatchDocApproved()\n  }\n\n  dispatchDocApproved = () => {\n    if (!window.DOCID_APPROVED) window.DOCID_APPROVED = {}\n    this.setState(prevState => ({\n      list: prevState.list.map(doc => {\n        if (window.DOCID_APPROVED[doc.id]) doc.approved = true\n        return doc\n      })\n    }))\n  }\n\n  async loadData() {\n    const duplicateHelper = new DuplicateHelper()\n    const token = Utils.getToken()\n    const [res, {data: lookbackArr}] = await Promise.all([\n      axios.get(`${Config.BACKEND}/feed?token=${token}`),\n      axios.get(`${Config.BACKEND}/lookback?token=${token}`),\n    ])\n    Utils.checkError(res)\n    duplicateHelper.pushLookbackData(lookbackArr);\n    this.setState({\n      loading: false,\n      list: res.data,\n      duplicateHelper,\n    })\n    this.dispatchDocApproved()\n  }\n\n  handleChange = name => event => {\n    this.setState({ [name]: event.target.value })\n  }\n\n  onClickEdit() {\n    this.setState({edit: true})\n  }\n\n  setDoc(i, data) {\n    this.setState(state => {\n      const list = state.list\n      list[i] = data\n      return {list}\n    })\n  }\n\n  openToolsDialog(doc) {\n    this.setState({\n      toolsDialogOpen: true,\n      toolsDialogDoc: doc\n    })\n  }\n\n  openDuplicateDocDialog(docs, docid) {\n    this.setState({\n      duplicateDocDialog: docs,\n      selectedDocID: docid,\n    })\n  }\n\n  render() {\n    var classes = {\n      input: {\n        marginBottom: '20px',\n        width: '500px',\n        maxWidth: '100%'\n      },\n      container: {\n        display: 'flex',\n        flexWrap: 'wrap',\n      },\n      cardStyle: {\n        //maxWidth: '800px',\n        marginTop: '20px',\n        marginRight: '20px',\n        marginLeft: '20px',\n      }\n    }\n\n    const loading = <div>\n      <br/><br/><br/>\n      <center><CircularProgress /></center>\n    </div>\n\n    const { gotoPublish } = this.props\n    const { duplicateDocDialog, duplicateHelper, selectedDocID } = this.state\n    const home = (\n      <React.Fragment>\n        <div style={classes.cardStyle}>\n          { this.state.list.length === 0 && <center><h2>Cha c bi ng no</h2></center> }\n          <ResponsiveMasonry\n            columnsCountBreakPoints={{350: 1, 1000: 2, 1550: 3}}\n          >\n            <Masonry gutter=\"10px\">\n              {this.state.list.map((doc, i) => {\n                return doc ? (\n                  <div key={doc.id}>\n                    <Doc\n                      doc={doc}\n                      setDoc={this.setDoc.bind(this)}\n                      i={i}\n                      admin\n                      gotoPublish={gotoPublish}\n                      openToolsDialog={this.openToolsDialog.bind(this)}\n                      openDuplicateDocDialog={this.openDuplicateDocDialog.bind(this)}\n                      duplicateHelper={duplicateHelper}\n                    />\n                  </div>\n                ) : null\n              })}\n            </Masonry>\n          </ResponsiveMasonry>\n        </div>\n        <ToolsDialog\n          open={this.state.toolsDialogOpen}\n          closeToolsDialog={() => this.setState({toolsDialogOpen: false})}\n          name={this.state.toolsDialogDoc.name}\n          psid={this.state.toolsDialogDoc.psid}\n          doc={this.state.toolsDialogDoc}\n        />\n        <DuplicateDocDialog\n          docs={duplicateDocDialog}\n          selectedDocID={selectedDocID}\n          closeDuplicateDocDialog={() => this.setState({duplicateDocDialog: null})}\n        />\n      </React.Fragment>\n    )\n\n    return this.state.loading ? loading : home\n  }\n}\n\nexport default Home","import React from 'react'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport axios from 'axios'\nimport Config from '../Config'\nimport Utils from '../Utils'\nimport Doc from '../components/Doc'\n\nconst classes = {\n  cardStyle: {\n    maxWidth: '800px',\n    marginTop: '20px',\n    marginRight: 'auto',\n    marginLeft: 'auto',\n  }\n}\n\nclass View extends React.Component {\n  constructor(props) {\n    super()\n    this.props = props\n    this.state = {\n      loading: true,\n      doc: {},\n    }\n    window.changeHeader('Qun l d liu - TongHopEvent')\n  }\n\n  componentDidMount() {\n    this.loadData()\n  }\n\n  async loadData() {\n    const token = Utils.getLocalStorage('token')\n    const res = await axios.get(`${Config.BACKEND}/doc/${this.props.id}?token=${token}`)\n    if (res.data.error)\n      this.setState({loading: false, doc: null})\n    else\n      this.setState({loading: false, doc: res.data})\n  }\n\n  _renderDocView() {\n    return (\n      <div style={classes.cardStyle}>\n        <Doc doc={this.state.doc || {}} />\n      </div>\n    )\n  }\n\n  _renderDocNotFound() {\n    return (\n      <center>\n        <br/><br/>\n        <h2>C li xy ra</h2>\n        Bi ng ny khng tn ti hoc  b xo<br/>\n        <br/><br/>\n      </center>\n    )\n  }\n\n  render() {\n    const loading = <div>\n      <br/><br/><br/>\n      <center><CircularProgress /></center>\n    </div>\n\n    return this.state.loading ? loading : \n      this.state.doc ? this._renderDocView() : this._renderDocNotFound()\n  }\n}\n\nexport default View","import 'date-fns';\nimport React from 'react';\nimport DateFnsUtils from '@date-io/date-fns';\nimport {\n  MuiPickersUtilsProvider,\n  KeyboardTimePicker,\n  KeyboardDatePicker,\n} from '@material-ui/pickers';\n\nclass MaterialUIPickers extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      publish_time: new Date(\n        Date.now() + 20 * 60 * 1000\n      )\n    }\n  }\n\n  componentDidMount() {\n    this.props.handleDateChange(this.state.publish_time.getTime() / 1000)\n  }\n\n  handleDateChange(date) {\n    this.setState({publish_time: date})\n    this.props.handleDateChange(date.getTime() / 1000)\n  }\n\n  render() {\n    const { publish_time } = this.state;\n\n    return (\n      <MuiPickersUtilsProvider utils={DateFnsUtils}>\n        <KeyboardDatePicker\n          margin=\"normal\"\n          id=\"mui-pickers-date\"\n          label=\"Date picker\"\n          value={publish_time}\n          onChange={this.handleDateChange.bind(this)}\n          KeyboardButtonProps={{\n            'aria-label': 'change date',\n          }}\n        />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n        <KeyboardTimePicker\n          margin=\"normal\"\n          id=\"mui-pickers-time\"\n          label=\"Time picker\"\n          value={publish_time}\n          onChange={this.handleDateChange.bind(this)}\n          KeyboardButtonProps={{\n            'aria-label': 'change time',\n          }}\n        />\n      </MuiPickersUtilsProvider>\n    );\n  }\n}\n\nexport default MaterialUIPickers;","import React, {useEffect, useState} from 'react';\nimport Button from '@material-ui/core/Button';\nimport Utils from '../Utils';\nimport DatePicker from '../components/DatePicker';\n\nconst ONE_DAY_IN_MS = 86400 * 1000;\nconst INTERVAL_BETWEEN_POSTS_IN_MS = 10 * 60000; // 10 mins\nconst FIX_TIME_OFFSET = -7 * 60 * 60000; // GMT+7\nconst MIN_SCHEDULED_TIME_INTERVAL = 20 * 60000; // must schedule at least 20 mins in advance\nconst NUMBER_OF_DAYS = 14;\nconst SLOTS = [\n  { hrs: 6,  min: 0,  priority: 3 },\n  { hrs: 6,  min: 20, priority: 2 },\n  { hrs: 6,  min: 40, priority: 1 },\n  { hrs: 7,  min: 0,  priority: 1 },\n  { hrs: 19, min: 0,  priority: 3 },\n  { hrs: 19, min: 30, priority: 4 },\n  { hrs: 20, min: 0,  priority: 8 },\n  { hrs: 20, min: 30, priority: 9 },\n  { hrs: 20, min: 45, priority: 4 },\n  { hrs: 21, min: 0,  priority: 7 },\n  { hrs: 21, min: 15, priority: 4 },\n  { hrs: 21, min: 30, priority: 7 },\n  { hrs: 21, min: 50, priority: 4 },\n  { hrs: 22, min: 10, priority: 1 },\n].map(s => ({...s, timeInDay: (s.hrs*3600 + s.min*60)*1000 }));\n\n/**\n * Here we suggest a slot by:\n * 1. build \"slots\" array with priority. Day 0 and 1 are prioritize diffrently\n * 2. sort \"slots\" array and decide\n * @param {*} _timeslots \n * @param {*} takenSlots \n * @param {*} feedback \n * @returns \n */\nconst getSuggestedSlot = (_timeslots, takenSlots, feedback) => {\n  const userSuggestedTime = getDayFromFeedback(feedback);\n  const timeslots = JSON.parse(JSON.stringify(_timeslots));\n  const slots = [];\n  // build slots array\n  for (const [i, {slotsOfDay}] of timeslots.entries()) {\n    if (i === 0) {\n      // day 0: priority > 5  ==> priority + 30\n      // day 0: priority <= 5 ==> priority + 10\n      for (const {time, priority} of slotsOfDay) {\n        if (priority > 5) slots.push({time, priority: priority + 30});\n        else slots.push({time, priority: priority + 10});\n      }\n    } else if (i === 1) {\n      // day 1: priority > 5  ==> priority + 20\n      // day 1: priority <= 5 ==> priority + 0\n      for (const {time, priority} of slotsOfDay) {\n        if (priority > 5) slots.push({time, priority: priority + 20});\n        else slots.push({time, priority: priority});\n      }\n    } else {\n      for (const {time, priority} of slotsOfDay) {\n        slots.push({time, priority: priority - i*10});\n      }\n    }\n  }\n  // sort & decide\n  slots.sort((a, b) => (a.priority < b.priority) ? 1 : -1);\n  console.log(slots.map(s => ({...s, t: new Date(s.time) })))\n  for (const {time} of slots) {\n    if (!takenSlots[time] && time > userSuggestedTime) return time;\n  }\n  return null;\n};\n\nconst getDayFromFeedback = (feedback) => {\n  const matched = feedback.match(/([0-9]+)\\/([0-9]+)/);\n  console.log(matched);\n  if (!matched) return 0;\n  const d = new Date(2021, parseInt(matched[2]) - 1, parseInt(matched[1]), 0, 0, 0, 0);\n  d.setTime(d.getTime() + d.getTimezoneOffset()*60000 - FIX_TIME_OFFSET)\n  console.log(d);\n  return d.getTime();\n};\n\n/**\n * slotsOfDay: [\n *  { hrs, min, priority, timeInDay, time: (exact EPOCH time in milisec) }\n * ]\n * @returns \n */\nconst generateTimeslots = () => {\n  const now = Date.now();\n  const beginOfTodayGMT = Math.floor(now / ONE_DAY_IN_MS) * ONE_DAY_IN_MS;\n\n  const timeslots = [];\n  let day = 0;\n  while (timeslots.length < NUMBER_OF_DAYS) {\n    const beginOfTodayLocal = beginOfTodayGMT + day*ONE_DAY_IN_MS + FIX_TIME_OFFSET;\n    const slotsOfDay = [];\n    for (const s of SLOTS) {\n      const time = beginOfTodayLocal + s.timeInDay;\n      if (time - now > MIN_SCHEDULED_TIME_INTERVAL) {\n        slotsOfDay.push({...s, time});\n      }\n    }\n    if (slotsOfDay.length > 2) timeslots.push({\n      startAt: beginOfTodayLocal,\n      slotsOfDay,\n    });\n    day++;\n  }\n\n  return timeslots;\n};\n\nconst getTakenSlotList = (stat, timeslots) => {\n  const res = {};\n  /**\n   *    +- INTERVAL_BETWEEN_POSTS_IN_MS\n   *                 <-x---|----->\n   * --|---------------|---|--\n   * time             post time\n   */\n  for (const {slotsOfDay} of timeslots) {\n    for (const {time} of slotsOfDay) {\n      const isSlotTaken = stat.some(scheduledTime =>\n        scheduledTime - INTERVAL_BETWEEN_POSTS_IN_MS < time\n        && time < scheduledTime + INTERVAL_BETWEEN_POSTS_IN_MS\n      );\n      if (isSlotTaken) res[time] = true;\n    }\n  }\n  return res;\n};\n\nconst ScheduledList = ({stat}) => {\n  const statAsc = JSON.parse(JSON.stringify(stat)).sort();\n  return <>\n    <p><b>Cc bi ng  ln lch</b></p>\n    <ul>\n      {statAsc.map(s => {\n        return <li key={s}>{Utils.getTimeStr(s)} ngy {Utils.getDateStr(s)}</li>\n      })}\n    </ul>\n  </>;\n};\n\nconst getDayLabel = (beginOfTodayLocal) => {\n  const now = Date.now();\n  if (beginOfTodayLocal < now && now < beginOfTodayLocal + ONE_DAY_IN_MS)\n    return '( Hm nay)';\n  else if (beginOfTodayLocal - ONE_DAY_IN_MS < now && now < beginOfTodayLocal)\n    return '(Ngy mai)';\n};\n\n// statArr = [int, int...]\nexport const TimeslotPicker = ({ statArr, value, onChange, feedback }) => {\n  const [useOldPicker, setUseOldPicker] = useState(false);\n  const [showMoreSlots, setShowMoreSlots] = useState(false);\n  const [timeslots] = useState(generateTimeslots());\n  const [takenSlots, setTakenSlots] = useState({});\n  const [suggestedSlot, setSuggestedSlot] = useState(null);\n  const val = value * 1000;\n\n  useEffect(() => {\n    const stat = JSON.parse(JSON.stringify(statArr));\n    const takenSlots = getTakenSlotList(stat, timeslots);\n    setTakenSlots(takenSlots);\n    console.log({stat, timeslots, takenSlots, feedback})\n    const suggested = getSuggestedSlot(timeslots, takenSlots, feedback);\n    if (suggested) {\n      setSuggestedSlot(suggested);\n      setTimeout(() => onChange(Math.round(suggested/1000)), 200);\n    }\n  // eslint-disable-next-line\n  }, [statArr]);\n\n  return <>\n    <p>\n      <b>Ln lch bi ng</b>{'   '}\n      <Button\n        variant='outlined'\n        size='small'\n        onClick={() => setUseOldPicker(!useOldPicker)}\n      >{useOldPicker ? 'Chn gi theo slot' : 'Chn gi th cng'}</Button>\n    </p>\n\n    {feedback && <p>\n      Gp  t ngi gi: {feedback}\n    </p>}\n\n    {!useOldPicker && <>\n      {suggestedSlot && <p>\n        Gi ng bi do my gi : <span className=\"highlighted\">{Utils.getTimeStr(suggestedSlot, 7)} ngy {Utils.getDateStr(suggestedSlot, 7)}</span>\n      </p>}\n      {timeslots.map((day, i) => (!showMoreSlots && i < 3) || showMoreSlots\n        ? <p key={day.startAt}>\n          <b>{getDayLabel(day.startAt)} {Utils.getDateStr(day.startAt, 7)}</b> (GMT+7)<br/>\n          {day.slotsOfDay.map(({time}) => <React.Fragment key={time}>\n            <Button\n              variant='outlined'\n              size='small'\n              color='primary'\n              className={val === time ? 'timeslot-selected' : ''}\n              onClick={() => onChange(Math.round(time/1000))}\n              disabled={takenSlots[time]}\n            >{Utils.getTimeStr(time, 7)}</Button>\n            {'  '}\n          </React.Fragment>)}\n        </p> : null\n      )}\n      {!showMoreSlots && <Button\n        variant='outlined'\n        size='small'\n        color='primary'\n        onClick={() => setShowMoreSlots(true)}\n      >+ Hin thm ngy</Button>}\n    </>}\n\n    {useOldPicker && <>\n      <DatePicker\n        handleDateChange={(date) => onChange(Math.round(date))}\n      />\n      <ScheduledList stat={statArr} />\n    </>}\n  </>\n}\n","import React from 'react'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport axios from 'axios'\nimport Config from '../Config'\nimport Utils from '../Utils'\nimport Card from '@material-ui/core/Card'\nimport CardContent from '@material-ui/core/CardContent'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Img from 'react-image'\nimport { TimeslotPicker } from '../components/Timeslots'\nimport Masonry, {ResponsiveMasonry} from 'react-responsive-masonry'\n\nconst classes = {\n  cardStyle: {\n    marginTop: '20px',\n    marginRight: '1em',\n    marginLeft: '1em',\n    display: 'flex',\n    flexWrap: 'wrap',\n  }\n}\n\nclass Publish extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      completed: false,\n      loading: true,\n      stat: null,\n      inboxData: null,\n    }\n    if (props.data) {\n      this.state.id = props.data.id\n      this.state.caption = props.data.caption\n      this.state.url = props.data.url\n      this.state.psid = props.data.psid\n      this.state.feedback = props.data.feedback || ''\n      this.state.scheduled_publish_time = 0\n    }\n    window.changeHeader('Cng c ng bi - TongHopEvent')\n  }\n\n  componentDidMount() {\n    this.loadStat()\n    this.loadInbox()\n  }\n\n  async loadStat() {\n    const token = Utils.getLocalStorage('token')\n    const res = await axios.get(`${Config.BACKEND}/publish/stat?token=${token}`)\n    if (res.data.error)\n      this.setState({loading: false, stat: []})\n    else\n      this.setState({loading: false, stat: res.data})\n  }\n\n  async loadInbox() {\n    const { data } = await Utils.makeRequest(`${Config.BACKEND}/inbox/${this.state.psid}`)\n    if (data && Object.keys(data).length > 0) {\n      this.setState({ inboxData: data })\n    }\n  }\n\n  getErrorMessage = (data) => {\n    if (data?.error?.message) {\n      return 'L do: ' + data.error.message\n    } else {\n      return 'Hy bo li cho Nui.'\n    }\n  }\n  \n  async doPublish() {\n    //this.setState({loading: true})\n    const token = Utils.getLocalStorage('token')\n    const idInDatabase = this.state.id\n    const postData = {\n      caption: this.state.caption,\n      url: this.state.url,\n      scheduled_publish_time: this.state.scheduled_publish_time\n    }\n    const toast = window.toastr.info('ang ng bi...', 'Publish tool', {timeOut: 60000})\n    window.location.hash = '#/manage'\n    const { data } = await axios.post(`${Config.BACKEND}/publish?token=${token}`, postData)\n    window.toastr.clear(toast)\n    if (data.id) {\n      window.toastr.success(' ng bi thnh cng!', 'Publish tool')\n      if (window.markDocApproved) window.markDocApproved(idInDatabase)\n    } else {\n      window.toastr.error('Li: Khng th ng bi. ' + this.getErrorMessage(data), 'Publish tool', {timeOut: 20000})\n    }\n  }\n\n  _renderComposerCard() {\n    const imgStyle = {\n      height: '300px',\n      maxWidth: '100%',\n    }\n    return (\n      <Card>\n        <CardContent>\n          <p>\n            <Button\n              variant='outlined'\n              size='small'\n              onClick={() => window.location.hash = '#/manage'}>Tr v</Button>\n            &nbsp;&nbsp;&nbsp;\n            <b>Son bi ng</b>\n          </p>\n          <center>\n            <Img alt=''\n              src={this.state.url}\n              style={imgStyle}\n              loader={<div style={imgStyle}><center><br/><br/><CircularProgress /></center></div>}\n            />  \n          </center>\n          <TextField\n            label=\"Ni dung bi ng\"\n            multiline\n            rowsMax=\"20\"\n            value={this.state.caption}\n            onChange={event => {this.setState({ caption: event.target.value });}}\n            margin=\"normal\"\n            variant=\"outlined\"\n            fullWidth\n          />\n        </CardContent>        \n      </Card>\n    )\n  }\n\n  _renderPublishCard() {\n    const { scheduled_publish_time, stat, feedback } = this.state\n    const isDateOK = (scheduled_publish_time - (Date.now() / 1000)) > 15*60\n    const s = scheduled_publish_time * 1000\n\n    return (\n      <Card>\n        <CardContent>\n          {stat && <TimeslotPicker\n            value={scheduled_publish_time}\n            statArr={stat}\n            onChange={(time) => this.setState({ scheduled_publish_time: time })}\n            feedback={feedback}\n          />}\n          <br/><br/>\n          {isDateOK && <Button variant='contained' color=\"primary\" onClick={() => {\n            window.showAlert({\n              title: 'Xc nhn ng bi',\n              text: `ng bi vo lc ${Utils.getTimeStr(s)} ngy ${Utils.getDateStr(s)} ?`,\n              onClickOK: this.doPublish.bind(this),\n              showCancel: true\n            })\n          }}>ng bi</Button>}\n          {!isDateOK && scheduled_publish_time > 0\n            && <p style={{color: 'red'}}>Gi ng bi phi cch hin ti t nht 15 pht</p>\n          }\n        </CardContent>\n      </Card>\n    )\n  }\n\n  _renderCompletedCard() {\n    const { scheduled_publish_time } = this.state\n    const s = scheduled_publish_time * 1000\n\n    return (\n      <div style={classes.cardStyle}>\n        <Card>\n          <CardContent>\n            <h2>ng bi thnh cng</h2>\n            <p>Bi vit  c t gi  ng vo lc {Utils.getTimeStr(s)} ngy {Utils.getDateStr(s)}</p>\n            <Button\n              variant='outlined'\n              onClick={() => window.location.hash = '#/'}>Tr v trang ch</Button>\n          </CardContent>\n        </Card>\n      <br/><br/>\n      </div>\n    )\n  }\n\n  _renderInboxCard() {\n    const { inboxData } = this.state;\n    return (\n      <Card>\n        <CardContent>\n          {!inboxData && <center><CircularProgress /></center>}\n          {inboxData && <>\n            <b>Tin nhn mi nht ( trn l mi, di l c)</b>\n            {'   '}\n            <Button\n              variant='outlined'\n              size='small'\n              onClick={() => Utils.goToInbox(inboxData)}\n            >M inbox</Button>\n            <br/>\n            ------<br/>\n            {inboxData.messages.data.map(msg => <p key={msg.id}>\n              <b>{msg.from.name}</b>: {msg.message}\n            </p>)}\n          </>}\n        </CardContent>        \n      </Card>\n    )\n  }\n\n  _renderMain() {\n    return (\n      <div style={{margin: '20px'}}>\n        <ResponsiveMasonry\n          columnsCountBreakPoints={{350: 1, 750: 2, 900: 2}}\n        >\n          <Masonry gutter=\"10px\">\n            {this._renderComposerCard()}\n            <div></div> {/* this is to make sure inboxCard is on the right */}\n            {this._renderPublishCard()}\n            {this._renderInboxCard()}\n          </Masonry>\n        </ResponsiveMasonry>\n        <br/><br/><br/>\n      </div>\n    )\n  }\n\n  _renderError() {\n    return (\n      <center>\n        <br/><br/>\n        <h2>C li xy ra</h2>\n        Hy vo trang ch v th li<br/>\n        <br/><br/>\n      </center>\n    )\n  }\n\n  render() {\n    const loading = <div>\n      <br/><br/><br/>\n      <center><CircularProgress /></center>\n    </div>\n\n    if (this.state.loading) return loading\n    if (this.state.completed) return this._renderCompletedCard()\n\n    return this.props.data ? this._renderMain() : this._renderError()\n  }\n}\n\nexport default Publish","import React from 'react'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport axios from 'axios'\nimport Utils from '../Utils'\nimport Card from '@material-ui/core/Card'\nimport CardContent from '@material-ui/core/CardContent'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Img from 'react-image'\n\nconst imgStyle = {\n  maxHeight: '300px',\n  maxWidth: '100%',\n}\n\nconst imgLoaderStyle = {\n  height: '300px',\n  width: '100%',\n}\n\nconst classes = {\n  cardStyle: {\n    maxWidth: '800px',\n    marginTop: '20px',\n    marginRight: 'auto',\n    marginLeft: 'auto',\n  }\n}\n\nclass GetImage extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      showGetToken: false,\n      access_token: '',\n      completed: false,\n      loading: true,\n      imgs: [],\n    }\n    if (props.data) {\n      this.state.caption = props.data.caption\n      this.state.fbusername = props.data.fbusername\n    } else {\n      this.state.error = 'Hy v trang ch v th li'\n    }\n    window.changeHeader('Chn nh bi ng - TongHopEvent')\n  }\n\n  componentDidMount() {\n    this.fetchFacebookApi()\n  }\n\n  async fetchFacebookApi() {\n    const fbtoken = Utils.getLocalStorage('fbtoken')\n    try {\n      const res = await axios.get(`https://graph.facebook.com/${this.state.fbusername}?fields=feed.limit(20)%7Bfull_picture%7D%2Cpicture.width(720)%7Burl%7D&access_token=${fbtoken}`)\n      if (res.data.error) {\n        this.setState({loading: false, showGetToken: true})\n      } else {\n        const imgs = res.data.feed.data.map(post => post.full_picture)\n        imgs.unshift(res.data.picture.data.url)\n        this.setState({\n          loading: false,\n          showGetToken: false,\n          imgs: imgs,\n        })\n      }\n    } catch (e) {\n      if (e.response.status === 404) {\n        this.setState({loading: false, error: 'Khng th m trang facebook ny'})\n      } else {\n        this.setState({loading: false, showGetToken: true})\n      }\n    }\n  }\n\n  onSaveToken() {\n    let fbtoken = this.state.access_token\n    fbtoken = fbtoken.match(/EA[a-zA-Z0-9]+/)\n    try {\n      Utils.setLocalStorage('fbtoken', fbtoken[0])\n      const urlNow = window.location.hash\n      window.location.hash = '#/reload'\n      setTimeout(() => { window.location.hash = urlNow }, 50)\n    } catch (e) {\n      window.alert('token khng hp l')\n    }\n  }\n\n  _renderTitleCard() {\n    return (\n      <Card>\n        <CardContent>\n          <p>\n            <Button\n              variant='outlined'\n              size='small'\n              onClick={() => window.location.hash = '#/'}>Tr v</Button>\n            &nbsp;&nbsp;&nbsp;\n            <b>Chn nh cho bi ng</b>\n          </p>\n        </CardContent>        \n      </Card>\n    )\n  }\n\n  _renderImageCard(url) {\n    return (\n      <Card>\n        <CardContent>\n          <center>\n            <Img alt=''\n              src={url}\n              style={imgStyle}\n              loader={<div style={imgLoaderStyle}><center><br/><br/><CircularProgress /></center></div>}\n            />  \n          </center>\n          <Button\n              variant='outlined'\n              size='small'\n              style={{ float: 'right', margin: '10px' }}\n              onClick={() => {\n                const _data = JSON.parse(JSON.stringify(this.props.data))\n                _data.url = url\n                this.props.gotoPublish(_data, 'publish')\n              }}>Chn nh ny</Button>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  _renderGetTokenCard() {\n    return (\n      <Card>\n        <CardContent>\n          <p>\n            <Button\n              variant='outlined'\n              size='small'\n              onClick={() => window.location.hash = '#/'}\n            >Tr v</Button>\n            &nbsp;&nbsp;&nbsp;\n            <b>Ly token</b><br/>\n            <br/>\n            Bn cha c token hoc token  b ht hn. Hy lm theo hng dn ny  ly token: <a href=\"https://blog.ngxson.com/tonghopevent/#lay-token\" target=\"_blank\" rel=\"noopener noreferrer\">[Bm vo y]</a><br/>\n            Lu : token s c lu trn my ny. Bn c th ly token t my tnh  dng trn T.<br/>\n            in token ca bn vo  di y:<br/>\n          </p>\n          <TextField\n            multiline\n            rowsMax=\"5\"\n            value={this.state.access_token}\n            onChange={event => {this.setState({ access_token: event.target.value });}}\n            margin=\"normal\"\n            variant=\"outlined\"\n            fullWidth\n          /><br/>\n          <Button\n            variant='outlined'\n            onClick={this.onSaveToken.bind(this)}\n          >Tip tc</Button>\n        </CardContent>        \n      </Card>\n    )\n  }\n\n  _renderMain() {\n    return (\n      <React.Fragment>\n        {this.state.showGetToken &&\n          <div style={classes.cardStyle}>\n            {this._renderGetTokenCard()}\n          </div>\n        }\n        {!this.state.showGetToken &&\n          <div style={classes.cardStyle}>\n            {this._renderTitleCard()}\n          </div>\n        }\n        {!this.state.showGetToken &&\n          this.state.imgs.map((url, i) =>\n            <div style={classes.cardStyle} key={i}>\n              {this._renderImageCard(url)}\n            </div>\n          )\n        }\n        <br />\n        <br />\n      </React.Fragment>\n    )\n  }\n\n  _renderError() {\n    return (\n      <center>\n        <br/><br/>\n        <h2>C li xy ra</h2>\n        {this.state.error}<br/><br/>\n        <Button\n          variant='outlined'\n          size='small'\n          onClick={() => window.location.hash = '#/'}\n        >Tr v</Button>\n        <br/><br/>\n      </center>\n    )\n  }\n\n  render() {\n    const loading = <div>\n      <br/><br/><br/>\n      <center><CircularProgress /></center>\n    </div>\n\n    if (this.state.loading) return loading\n    if (this.state.error) return this._renderError()\n\n    return this._renderMain()\n  }\n}\n\nexport default GetImage","import React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\n\nclass Alert extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      open: false,\n      onClickOK: null\n    }\n    window.showAlert = this.show.bind(this)\n  }\n\n  show(data) {\n    this.setState({\n      open: true,\n      title: data.title,\n      text: data.text,\n      onClickOK: data.onClickOK || null,\n      showCancel: data.showCancel\n    })\n  }\n\n  handleClickOK = () => {\n    if (this.state.onClickOK) {\n      this.state.onClickOK();\n      this.setState({ onClickOK: null });\n    }\n    this.setState({ open: false });\n  };\n\n  handleCancel = () => {\n    this.setState({ open: false });\n  };\n\n  render() {\n    return (\n      <div>\n        <Dialog\n          open={this.state.open}\n          onClose={this.handleCancel}\n          aria-labelledby=\"alert-dialog-title\"\n          aria-describedby=\"alert-dialog-description\"\n        >\n          <DialogTitle id=\"alert-dialog-title\">{this.state.title}</DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"alert-dialog-description\">\n              {this.state.text}\n            </DialogContentText>\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={this.handleClickOK.bind(this)} color=\"primary\" autoFocus>OK</Button>\n            {this.state.showCancel\n              ? <Button onClick={this.handleCancel.bind(this)} color=\"primary\" autoFocus>Cancel</Button>\n              : null}\n          </DialogActions>\n        </Dialog>\n      </div>\n    );\n  }\n}\n\nexport default Alert;","import React from 'react'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport axios from 'axios'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogContentText from '@material-ui/core/DialogContentText'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport PropTypes from 'prop-types'\nimport Utils from '../Utils'\n\nclass FBPostEditDialog extends React.Component {\n  constructor(props) {\n    super(props)\n    console.log(props.post)\n    this.state = {\n      title: props.post.message.split('\\n')[0] || '',\n      message: props.post.message,\n      loading: false,\n    }\n  }\n\n  static propTypes = {\n    onClose: PropTypes.func.isRequired,\n    post: PropTypes.any.isRequired,\n    editPostEndpoint: PropTypes.string.isRequired,\n  }\n\n  onEditPost = async () => {\n    const { message } = this.state\n    const { post, onClose } = this.props\n    this.setState({ loading: true })\n    const token = Utils.getLocalStorage('token')\n    await axios.patch(`${this.props.editPostEndpoint}/${post.id}?token=${token}`, {\n      message: message\n    })\n    onClose(true);\n  }\n\n  render() {\n    const { title, message, loading } = this.state\n    const { post, onClose } = this.props\n\n    return (\n      <React.Fragment>\n        <Dialog fullWidth={true} open={true} onClose={() => onClose(false)} aria-labelledby=\"form-dialog-title\">\n          {loading ? <center><br/><br/><CircularProgress /><br/><br/></center> : <>\n            <DialogTitle id=\"form-dialog-title\">Sa bi vit</DialogTitle>\n            <DialogContent>\n              <DialogContentText>\n                Bi vit: {title}<br/>\n                ng lc: {Utils.getTimeStr(post.time)} ngy {Utils.getDateStr(post.time)}\n              </DialogContentText>\n              <TextField\n                multiline\n                rowsMax=\"20\"\n                value={message}\n                onChange={event => {this.setState({ message: event.target.value })}}\n                margin=\"normal\"\n                variant=\"outlined\"\n                fullWidth\n              />\n            </DialogContent>\n            <DialogActions>\n              <Button onClick={() => onClose(false)} color=\"primary\">\n                Quay li\n              </Button>\n              <Button onClick={this.onEditPost} color=\"primary\">\n                LU POST\n              </Button>\n            </DialogActions>\n          </>}\n        </Dialog>\n      </React.Fragment>\n    )\n  }\n}\n\nexport default FBPostEditDialog\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport axios from 'axios'\nimport Img from 'react-image'\nimport Utils from '../../Utils'\nimport Config from '../../Config'\nimport Card from '@material-ui/core/Card'\nimport CardContent from '@material-ui/core/CardContent'\nimport Button from '@material-ui/core/Button'\nimport FBPostEditDialog from '../../components/FBPostEditDialog'\n\nconst classes = {\n  cardStyle: {\n    maxWidth: '800px',\n    marginTop: '20px',\n    marginRight: 'auto',\n    marginLeft: 'auto',\n  }\n}\n\nconst imgStyle = {\n  height: '300px',\n  maxWidth: '100%',\n}\n\nconst ImgLoader = () => <div style={imgStyle}><center><br/><br/><CircularProgress /></center></div>\n\nclass PostList extends React.Component {\n  constructor(props) {\n    super()\n    this.props = props\n    this.state = {\n      loading: true,\n      posts: [],\n      editingPost: null,\n    }\n    window.changeHeader('Bi  ln lch - TongHopEvent')\n  }\n\n  static propTypes = {\n    loadFeedEndpoint: PropTypes.string.isRequired,\n    editPostEndpoint: PropTypes.string.isRequired,\n    deletePostEndpoint: PropTypes.string.isRequired,\n    timeFieldName: PropTypes.string.isRequired,\n    newestFirst: PropTypes.bool,\n  };\n\n  componentDidMount() {\n    this.loadData()\n  }\n\n  async loadData() {\n    const { newestFirst } = this.props;\n    this.setState({loading: true, editingPost: null})\n    const token = Utils.getLocalStorage('token')\n    const res = await axios.get(`${this.props.loadFeedEndpoint}?token=${token}`)\n    if (res.data.error)\n      this.setState({loading: false, posts: []})\n    else {\n      const arr = newestFirst ? res.data : res.data.reverse()\n      this.setState({loading: false, posts: this.processTimeField(arr) })\n    }\n  }\n\n  processTimeField = (data) => {\n    if (this.props.timeFieldName === 'created_time') {\n      return data.map(p => ({\n        ...p,\n        created_time: (new Date(p.created_time)).getTime() / 1000,\n      }))\n    } else {\n      return data\n    }\n  }\n\n  deletePost = (post) => async () => {\n    if (window.confirm('Bn c chc chn xa?')) {\n      this.setState({loading: true})\n      const token = Utils.getLocalStorage('token')\n      await axios.delete(`${this.props.deletePostEndpoint}/${post.id}?token=${token}`)\n      this.loadData()\n    }\n  }\n\n  openOnFB = (post) => () => {\n    window.open(`https://www.facebook.com/${post.id}`, '_blank').focus();\n  }\n\n  onEditDialogClose = (shouldReload) => {\n    if (shouldReload) {\n      this.loadData()\n    } else {\n      this.setState({editingPost: null})\n    }\n  }\n\n  _renderMainView() {\n    const { timeFieldName } = this.props;\n\n    return this.state.posts.map((post, i) => {\n      const isFromUser = post.from && post.from.id !== Config.SELF_PAGE_ID;\n      return <div style={classes.cardStyle} key={post.id}>\n        <Card>\n          <CardContent>\n            <p><b>{Utils.getTimeStr(post[timeFieldName] * 1000)} ngy {Utils.getDateStr(post[timeFieldName] * 1000)}</b></p>\n            <Img alt=''\n              src={post.full_picture}\n              style={imgStyle}\n              loader={<ImgLoader />}\n            />\n            {isFromUser && <p style={{\n                backgroundColor: '#eee',\n                padding: '10px',\n                fontWeight: 'bold',\n              }}\n              children=\"(Bi vit ny do c gi ng ln page)\"\n            />}\n            <p>\n              {Utils.nl2br(post.expanded ? post.message : post.message.substring(0, 250))}\n              <br/>\n              {/* eslint-disable */}\n              <a href=\"#\" onClick={(e) => {\n                e.preventDefault()\n                this.setState({posts: this.state.posts.map((p, j) => {\n                  const cloned = JSON.parse(JSON.stringify(p))\n                  if (i === j) cloned.expanded = !cloned.expanded\n                  return cloned\n                })})\n              }}>{post.expanded ? 'Thu gn' : '... c thm'}</a><br/>\n              {/* eslint-enable */}\n            </p>\n            <p>\n              <Button color=\"primary\" variant=\"outlined\" onClick={this.deletePost(post)}>Xa</Button>\n              &nbsp;&nbsp;\n              <Button color=\"primary\" variant=\"outlined\" onClick={() => this.setState({ editingPost: post })} disabled={isFromUser}>Sa</Button>\n              &nbsp;&nbsp;\n              <Button color=\"primary\" variant=\"outlined\" onClick={this.openOnFB(post)}>Xem trn FB</Button>\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n    })\n  }\n\n  _renderDocNotFound() {\n    return (\n      <center>\n        <br/><br/>\n        (Khng c d liu)<br/>\n        <br/><br/>\n      </center>\n    )\n  }\n\n  render() {\n    const { editingPost, loading, posts } = this.state\n\n    const loadingComponent = <div>\n      <br/><br/><br/>\n      <center><CircularProgress /></center>\n    </div>\n\n    return <>\n      {editingPost && <FBPostEditDialog\n        post={editingPost}\n        onClose={this.onEditDialogClose}\n        editPostEndpoint={this.props.editPostEndpoint}\n      />}\n      {loading ? loadingComponent : \n        posts.length > 0 ? this._renderMainView() : this._renderDocNotFound()\n      }\n    </>\n  }\n}\n\nexport default PostList","import React from 'react'\nimport PostList from './PostList'\nimport Config from '../../Config'\n\nconst Scheduled = () => {\n  return <PostList\n    loadFeedEndpoint={`${Config.BACKEND}/publish/scheduled`}\n    editPostEndpoint={`${Config.BACKEND}/publish/post`}\n    deletePostEndpoint={`${Config.BACKEND}/publish/post`}\n    timeFieldName=\"scheduled_publish_time\"\n    newestFirst={false}\n  />\n}\n\nexport default Scheduled","import React from 'react'\nimport PostList from './PostList'\nimport Config from '../../Config'\n\nconst FBFeed = () => {\n  return <PostList\n    loadFeedEndpoint={`${Config.BACKEND}/fbfeed`}\n    editPostEndpoint={`${Config.BACKEND}/fbfeed`}\n    deletePostEndpoint={`${Config.BACKEND}/fbfeed`}\n    timeFieldName=\"created_time\"\n    newestFirst={true}\n  />\n}\n\nexport default FBFeed","import React from 'react'\nimport Utils from '../Utils'\nimport Card from '@material-ui/core/Card'\nimport CardContent from '@material-ui/core/CardContent'\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\nimport Switch from '@material-ui/core/Switch'\nimport Button from '@material-ui/core/Button'\n\n\nconst classes = {\n  cardStyle: {\n    maxWidth: '800px',\n    marginTop: '20px',\n    marginRight: 'auto',\n    marginLeft: 'auto',\n  }\n}\n\nclass Settings extends React.Component {\n  state = {\n    ...Utils.settings,\n  }\n\n  saveSettings = () => {\n    Utils.setSettings({\n      ...this.state,\n    });\n    window.toastr.success(' lu ci t');\n  }\n\n  render() {\n    const { markReadOnOpenInbox } = this.state;\n\n    return (\n      <div style={classes.cardStyle}>\n        <Card>\n          <CardContent>\n            <p>\n              <h2>Ci t</h2><br/>\n              Lu : Cc ci t sau s c lu trn trnh duyt ny. Nu bn i thit b khc, bn cn chnh li cho thit b .\n            </p>\n            <FormControlLabel\n              control={\n                <Switch\n                  checked={markReadOnOpenInbox}\n                  onChange={() => this.setState({ markReadOnOpenInbox: !markReadOnOpenInbox })}\n                  color=\"primary\"\n                />\n              }\n              label={'nh du \" c\" khi bm vo c inbox'}\n            />\n            <br/>\n            <br/>\n            <Button\n              variant='outlined'\n              onClick={this.saveSettings}\n            >Lu ci t</Button>\n          </CardContent>        \n        </Card>\n      </div>\n    )\n  }\n}\n\nexport default Settings","import { io } from 'socket.io-client';\nimport Utils from '../../Utils';\nimport Config from '../../Config';\n\nclass Socket {\n  static socket = null;\n  static getSocket() {\n    if (!Config.SOCKETIO) return null;\n    if (!Socket.socket) {\n      Socket.socket = io(Config.SOCKETIO, {\n        transports: ['websocket'],\n        query: `module=${Config.SOCKETIO_MODULE}&token=${Utils.getToken()}`,\n      });\n      Socket.socket.on('connect', () => console.log('connected'));\n    }\n    return Socket.socket;\n  }\n\n  static subscribeInbox(handler) {\n    const socket = Socket.getSocket();\n    if (socket) socket.on('inbox', handler);\n  }\n\n  static unsubscribeInbox(handler) {\n    const socket = Socket.getSocket();\n    if (socket) socket.offAny(handler);\n  }\n}\n\n/* eslint-disable */\nfunction uuidv4() {\n  return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>\n    (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\n  );\n}\n/* eslint-enable */\n\n/**\n * make HTTP requests via socket.io\n * @param {*} method \n * @param {*} endpoint \n * @param {*} query \n * @param {*} body \n */\nexport const makeRequest = (method, endpoint, query = {}, body = {}) => new Promise(resolve => {\n  if (!Config.PROD) console.log(method, endpoint, query, body);\n  const socket = Socket.getSocket();\n  const requestId = uuidv4();\n  const callback = (data) => {\n    socket.offAny(callback);\n    resolve(data);\n  };\n  socket.on(requestId, callback);\n  socket.emit(`${method.toLowerCase()} ${endpoint.replace(/\\/$/, '')}`, {\n    requestId,\n    query,\n    body,\n  });\n});\n\nexport default Socket;","import React from 'react';\nimport Socket, { makeRequest } from './socket';\nimport Config from '../../Config';\n\nexport const MessengerContext = React.createContext();\n\nexport class MessengerContextProvider extends React.Component {\n  state = {\n    unreadMark: {},\n  };\n\n  componentDidMount() {\n    if (Config.INBOX_UNREAD_ABILITY) {\n      this.fetchUnread();\n    }\n  }\n\n  fetchUnread = async () => {\n    const res = await makeRequest('get', '/unread');\n    const unreadMark = {};\n    for (const { id } of res) {\n      unreadMark[id] = true;\n    }\n    this.setState({ unreadMark });\n  }\n\n  markUnread = (psid) => {\n    Socket.getSocket().emit('mark_unread', psid);\n    const unreadMark = {...this.state.unreadMark};\n    unreadMark[psid] = true;\n    this.setState({ unreadMark });\n  }\n\n  markRead = (psid) => {\n    Socket.getSocket().emit('mark_read', psid);\n    const unreadMark = {...this.state.unreadMark};\n    delete unreadMark[psid];\n    this.setState({ unreadMark });\n  }\n\n  render() {\n    return (\n      <MessengerContext.Provider value={{\n        unreadMark: this.state.unreadMark,\n        markUnread: this.markUnread,\n        markRead: this.markRead,\n      }}>\n        {this.props.children}\n      </MessengerContext.Provider>\n    );\n  }\n}\n\n\nexport function withMessengerContext(Component) {\n  return function HOC(props) {\n    return (\n      <MessengerContext.Consumer>\n        {(contexts) => <Component {...props} {...contexts} />}\n      </MessengerContext.Consumer>\n    )\n  }\n}\n","import React from 'react';\nimport {\n  ConversationList,\n  Conversation,\n} from \"@chatscope/chat-ui-kit-react\";\nimport { removeVietnameseTones, mergeNewConversations, getTargetId } from './utils';\nimport Socket, { makeRequest } from './socket';\nimport Config from '../../Config';\nimport { withMessengerContext } from './Context';\n\nclass Conversations extends React.Component {\n  state = {\n    ready: false,\n    loading: false,\n    conversations: [],\n    next: null,\n  };\n\n  openConversation = (id, name) => () => {\n    const n = removeVietnameseTones(name.toLowerCase()).replace(/[^a-z0-9]+/g, '-');\n    window.location.hash = `#/msg/${id}/${n}`;\n  }\n\n  componentDidMount() {\n    this.loadMoreConversations();\n    Socket.subscribeInbox(this.inboxUpdateHandler);\n  }\n\n  componentWillUnmount() {\n    Socket.unsubscribeInbox(this.inboxUpdateHandler);\n  }\n\n  inboxUpdateHandler = async (ev) => {\n    const { data: newArr } = await makeRequest('get', '/conversations', {limit: 5});\n    this.setState((prevState) => ({\n      conversations: mergeNewConversations(prevState.conversations, newArr),\n    }));\n  }\n\n  async loadMoreConversations() {\n    if (!this.state.loading) {\n      this.setState({ loading: true });\n\n      const qs = {};\n      if (this.state.next) qs.after = this.state.next;\n      let { data, paging } = await makeRequest('get', '/conversations', qs);\n\n      if (Config.PROD) {\n        data = data.filter(c => c.id !== Config.INBOX_IGNORED_CONVERSATION);\n      }\n\n      if (data) this.setState({\n        conversations: [...this.state.conversations, ...data],\n        loading: false,\n        ready: true,\n        next: (paging?.next) ? (paging?.cursors?.after) : null,\n      });\n    }\n  }\n\n  onYReachEnd = () => {\n    if (this.state.next && !this.state.loading) {\n      this.loadMoreConversations();\n    }\n  }\n\n  render() {\n    const { unreadMark } = this.props;\n\n    return (\n      <ConversationList\n        loading={!this.state.ready}\n        loadingMore={this.state.ready && this.state.loading}\n        onYReachEnd={this.onYReachEnd}\n      >\n        {this.state.conversations.map(conv => {\n          const name = conv.senders.data[0].name;\n          const psid = getTargetId(conv);\n          return (\n            <Conversation\n              key={conv.id}\n              name={`${name} (${conv.message_count})`}\n              info={conv.snippet}\n              onClick={this.openConversation(conv.id, name)}\n              active={this.props.tid === conv.id}\n              unreadDot={!!unreadMark[psid]}\n            ></Conversation>\n          );\n        })}\n      </ConversationList>\n    );\n  }\n}\n\nexport default withMessengerContext(Conversations);","import React from 'react';\nimport {\n  ConversationHeader,\n  Avatar,\n  InfoButton,\n  Button,\n} from \"@chatscope/chat-ui-kit-react\";\nimport { withMessengerContext } from './Context';\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faEnvelope } from \"@fortawesome/free-solid-svg-icons/faEnvelope\";\nimport { faEnvelopeOpenText } from \"@fortawesome/free-solid-svg-icons/faEnvelopeOpenText\";\nimport Config from '../../Config';\n\nconst MarkButton = withMessengerContext(({psid, unreadMark, markRead, markUnread}) => {\n  const btnClick = () => {\n    if (unreadMark[psid]) {\n      markRead(psid);\n    } else {\n      markUnread(psid);\n    }\n  }\n\n  return (\n    <Button\n      className={'cs-button cs-button--info'}\n      style={{marginRight: '20px'}}\n      icon={<FontAwesomeIcon icon={unreadMark[psid] ? faEnvelopeOpenText : faEnvelope} />}\n      onClick={btnClick}\n    ></Button>\n  );\n});\n\nconst Header = ({loading, profile, openConversationOnFB, openMainMenu, psid}) => {\n  return loading\n    ? (\n      <ConversationHeader>\n        <ConversationHeader.Back onClick={openMainMenu} />\n        <ConversationHeader.Content userName=\"Loading...\" />        \n      </ConversationHeader>\n    ) : (\n      <ConversationHeader>\n        <ConversationHeader.Back onClick={openMainMenu} />\n        <Avatar\n          src={profile.profile_pic}\n          name={profile.name}\n          onClick={openConversationOnFB}\n        />\n        <ConversationHeader.Content userName={profile.name} />\n        <ConversationHeader.Actions>\n          {Config.INBOX_UNREAD_ABILITY && (\n            <MarkButton\n              as=\"InfoButton\"\n              psid={psid}\n            />\n          )}\n          <InfoButton onClick={openConversationOnFB} />\n        </ConversationHeader.Actions>          \n      </ConversationHeader>\n    );\n}\n\nexport default Header;","import React, {\n  Component,\n  useRef,\n  useState,\n  useEffect,\n  useImperativeHandle,\n  forwardRef,\n} from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\n//import { prefix } from \"../settings\";\n// import ContentEditable from \"../ContentEditable\";\nimport {\n  SendButton,\n  AttachmentButton,\n} from \"@chatscope/chat-ui-kit-react\";\n// import PerfectScrollbar from \"../Scroll\";\nimport TextareaAutosize from 'react-textarea-autosize';\n\nconst noop = () => {};\nconst prefix = 'cs';\n\n// Because container depends on fancyScroll\n// it must be wrapped in additional container\nfunction editorContainer() {\n  class Container extends Component {\n    render() {\n      const {\n        props: { fancyScroll, children, forwardedRef, ...rest },\n      } = this;\n\n      return (\n        <>\n          {/*fancyScroll === true && (\n            <PerfectScrollbar\n              ref={(elRef) => (forwardedRef.current = elRef)}\n              {...rest}\n              options={{ suppressScrollX: true }}\n            >\n              {children}\n            </PerfectScrollbar>\n          )*/}\n          {/*fancyScroll === false && (\n            <div ref={forwardedRef} {...rest}>\n              {children}\n            </div>\n          )*/}\n          <div ref={forwardedRef} {...rest}>\n            {children}\n          </div>\n        </>\n      );\n    }\n  }\n\n  return React.forwardRef((props, ref) => {\n    return <Container forwardedRef={ref} {...props} />;\n  });\n}\n\nconst EditorContainer = editorContainer();\n\nconst useControllableState = (value, initialValue) => {\n  const initial = typeof value !== \"undefined\" ? value : initialValue;\n  const [stateValue, setStateValue] = useState(initial);\n  const effectiveValue = typeof value !== \"undefined\" ? value : stateValue;\n\n  return [\n    effectiveValue,\n    (newValue) => {\n      setStateValue(newValue);\n    },\n  ];\n};\n\nfunction MessageInputInner(\n  {\n    value,\n    onSend,\n    onChange,\n    autoFocus,\n    placeholder,\n    fancyScroll,\n    className,\n    activateAfterChange,\n    disabled,\n    sendDisabled,\n    sendOnReturnDisabled,\n    attachDisabled,\n    sendButton,\n    attachButton,\n    onAttachClick,\n    ...rest\n  },\n  ref\n) {\n  const scrollRef = useRef();\n  const msgRef = useRef();\n  const [stateValue, setStateValue] = useControllableState(value, \"\");\n  // eslint-disable-next-line\n  const [stateSendDisabled, setStateSendDisabled] = useControllableState(\n    sendDisabled,\n    true\n  );\n\n  // Public API\n  const focus = () => {\n    if (typeof msgRef.current !== \"undefined\") {\n      msgRef.current.focus();\n    }\n  };\n\n  // Return object with public Api\n  useImperativeHandle(ref, () => ({\n    focus,\n  }));\n\n  // Set focus\n  useEffect(() => {\n    if (autoFocus === true) {\n      focus();\n    }\n  }, [autoFocus]);\n\n  // Update scroll\n  useEffect(() => {\n    if (typeof scrollRef.current.updateScroll === \"function\") {\n      scrollRef.current.updateScroll();\n    }\n  });\n\n  // eslint-disable-next-line\n  const getContent = () => {\n    // Direct reference to contenteditable div\n    const contentEditableRef = msgRef.current.msgRef.current;\n    return [\n      contentEditableRef.textContent,\n      contentEditableRef.innerText,\n      contentEditableRef.cloneNode(true).childNodes,\n    ];\n  };\n\n  const send = () => {\n    if (stateValue.length > 0) {\n      // // Clear input only when it's uncontrolled mode\n      // if (value === undefined) {\n      //   setStateValue(\"\");\n      // }\n\n      // // Disable send button only when it's uncontrolled mode\n      // if (typeof sendDisabled === \"undefined\") {\n      //   setStateSendDisabled(true);\n      // }\n\n      // const content = getContent();\n\n      // onSend(stateValue, content[0], content[1], content[2]);\n      onSend();\n    }\n  };\n\n  const handleKeyPress = (evt) => {\n    if (evt.key === \"Enter\" && evt.shiftKey === false && sendOnReturnDisabled === false) {\n      evt.preventDefault();\n      send();\n    }\n  };\n\n  const handleChange = (ev) => {\n    // (innerHTML, textContent, innerText) => {\n    // setStateValue(innerHTML);\n    // if (typeof sendDisabled === \"undefined\") {\n    //   setStateSendDisabled(textContent.length === 0);\n    // }\n\n    // if (typeof scrollRef.current.updateScroll === \"function\") {\n    //   scrollRef.current.updateScroll();\n    // }\n\n    // const content = getContent();\n\n    // onChange(innerHTML, textContent, innerText, content[2]);\n    setStateValue(ev.target.value);\n    onChange(ev.target.value);\n  };\n\n  const cName = `${prefix}-message-input`,\n    ph = typeof placeholder === \"string\" ? placeholder : \"\";\n\n  return (\n    <div\n      {...rest}\n      className={classNames(\n        cName,\n        { [`${cName}--disabled`]: disabled },\n        className\n      )}\n    >\n      {attachButton === true && (\n        <div className={`${cName}__tools`}>\n          <AttachmentButton\n            onClick={onAttachClick}\n            disabled={disabled === true || attachDisabled === true}\n          />\n        </div>\n      )}\n\n      <div className={`${cName}__content-editor-wrapper`}>\n        <EditorContainer\n          fancyScroll={fancyScroll}\n          ref={scrollRef}\n          className={`${cName}__content-editor-container`}\n        >\n          <TextareaAutosize\n            ref={msgRef}\n            className={`${cName}__content-editor`}\n            disabled={disabled}\n            placeholder={ph}\n            onKeyPress={handleKeyPress}\n            onChange={handleChange}\n            // activateAfterChange={activateAfterChange}\n            value={stateValue}\n            maxRows={5}\n            minRows={1}\n          />\n        </EditorContainer>\n      </div>\n      {sendButton === true && (\n        <div className={`${cName}__tools`}>\n          <SendButton\n            onClick={send}\n            disabled={disabled === true || stateSendDisabled === true}\n          />\n        </div>\n      )}\n    </div>\n  );\n}\n\nconst MessageInput = forwardRef(MessageInputInner);\nMessageInput.displayName = \"MessageInput\";\n\nMessageInput.propTypes = {\n  /** Value. */\n  value: PropTypes.string,\n\n  /** Placeholder. */\n  placeholder: PropTypes.string,\n\n  /** A input can show it is currently unable to be interacted with. */\n  disabled: PropTypes.bool,\n\n  /** Prevent that the input message is sent on a return press */\n  sendOnReturnDisabled: PropTypes.bool,\n\n  /** Send button can be disabled.<br>\n   * It's state is tracked by component, but it can be forced */\n  sendDisabled: PropTypes.bool,\n\n  /**\n   * Fancy scroll\n   * This property is set in contructor, and is not changing when component update.\n   */\n  fancyScroll: PropTypes.bool,\n\n  /**\n   * Sets focus element and caret at the end of input<br>\n   * when value is changed programmatically (e.g) from button click and element is not active\n   */\n  activateAfterChange: PropTypes.bool,\n\n  /** Set focus after mount. */\n  autoFocus: PropTypes.bool,\n\n  /**\n   * onChange handler<br>\n   * @param {String} innerHtml\n   * @param {String} textContent\n   * @param {String} innerText\n   * @param {NodeList} nodes\n   */\n  onChange: PropTypes.func,\n\n  /**\n   * onSend handler<br>\n   * @param {String} innerHtml\n   * @param {String} textContent\n   * @param {String} innerText\n   * @param {NodeList} nodes\n   */\n  onSend: PropTypes.func,\n\n  /** Additional classes. */\n  className: PropTypes.string,\n\n  /** Show send button */\n  sendButton: PropTypes.bool,\n\n  /** Show add attachment button */\n  attachButton: PropTypes.bool,\n\n  /** Disable add attachment button */\n  attachDisabled: PropTypes.bool,\n\n  /**\n   * onAttachClick handler\n   */\n  onAttachClick: PropTypes.func,\n};\n\nMessageInputInner.propTypes = MessageInput.propTypes;\n\nMessageInput.defaultProps = {\n  value: undefined,\n  placeholder: \"\",\n  disabled: false,\n  sendOnReturnDisabled: false,\n  fancyScroll: true,\n  activateAfterChange: false,\n  autoFocus: false,\n  sendButton: true,\n  attachButton: true,\n  attachDisabled: false,\n  onAttachClick: noop,\n  onChange: noop,\n  onSend: noop,\n};\n\nMessageInputInner.defaultProps = MessageInput.defaultProps;\n\nexport { MessageInput };\n\nexport default MessageInput;","import React from 'react';\nimport {\n  MessageList,\n  ChatContainer,\n  Message,\n} from \"@chatscope/chat-ui-kit-react\";\nimport { getMessageDirection, getTargetId, mergeNewMessages } from './utils';\nimport TimeAgo from 'javascript-time-ago';\nimport en from 'javascript-time-ago/locale/en';\nimport Socket, { makeRequest } from './socket';\nimport Config from '../../Config';\nimport './styles.css';\nimport Header from './Header';\nimport MessageInput from './MessageInput';\nimport { withMessengerContext } from './Context';\nimport { makeRequest as makeRequestSendAPI } from '../../Utils';\n\nTimeAgo.addLocale(en);\nconst timeAgo = new TimeAgo('en-US');\n\nclass MessageView extends React.Component {\n  state = {\n    loading: true,\n    loadingMore: false,\n    psid: null,\n    profile: {},\n    threadInfo: {},\n    messages: [],\n    messageAfter: null,\n    messagePending: null,\n    messagePendingId: null,\n    input: '',\n  }\n  originalTitle = document.title;\n\n  componentDidMount() {\n    this.fetchConversation(this.props.tid);\n    Socket.subscribeInbox(this.inboxUpdateHandler);\n    window.setMessageInput = (input) => this.setState({ input });\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.tid !== this.props.tid) {\n      this.fetchConversation(this.props.tid);\n    }\n    if (this.state.psid\n      && this.state.psid !== prevState.psid\n      && Config.INBOX_MARK_READ_ON_OPEN\n    ) {\n      this.props.markRead(this.state.psid);\n    }\n  }\n\n  componentWillUnmount() {\n    document.title = this.originalTitle;\n    Socket.unsubscribeInbox(this.inboxUpdateHandler);\n  }\n\n  inboxUpdateHandler = async (ev) => {\n    const { psid, messagePendingId } = this.state;\n    const tid = this.props.tid;\n    if (getTargetId(ev) === psid) {\n      const { data: newMessages } = await makeRequest('get', '/thread/messages', {tid, limit: 5});\n      this.setState((prevState) => ({\n        messages: mergeNewMessages(prevState.messages, newMessages),\n      }));\n    }\n    if (ev.message?.mid === messagePendingId) {\n      this.setState({ messagePending: null, messagePendingId: null });\n    }\n  }\n\n  async fetchConversation(tid) {\n    document.title = Config.INBOX_TITLE;\n    this.setState({ loading: true });\n    const [threadInfo, messages] = await Promise.all([\n      makeRequest('get', '/thread/info', {tid}),\n      makeRequest('get', '/thread/messages', {tid}),\n    ]);\n    messages.data = messages.data.reverse();\n    const psid = threadInfo.senders.data[0].id;\n    const profile = await makeRequest('get', '/profile', { psid });\n    this.setState({\n      threadInfo,\n      psid,\n      profile,\n      messages: messages.data,\n      messageAfter: (messages.paging?.next) ? (messages.paging?.cursors?.after) : null,\n      loading: false,\n    });\n    document.title = `${profile.name} - ${Config.INBOX_TITLE}`;\n  }\n\n  onYReachStart = async () => {\n    const {messageAfter, loadingMore} = this.state;\n    if (messageAfter && !loadingMore) {\n      this.setState({ loadingMore: true });\n      const messages = await makeRequest('get', '/thread/messages', {\n        tid: this.props.tid,\n        after: messageAfter,\n      });\n      this.setState((prevState) => {\n        const newMsgArr = messages.data.reverse().concat(prevState.messages);\n        return {\n          messages: newMsgArr,\n          messageAfter: (messages.paging?.next) ? (messages.paging?.cursors?.after) : null,\n          loadingMore: false,\n        };\n      });\n    }\n  }\n\n  openConversationOnFB = () => {\n    window.open(`https://fb.com${this.state.threadInfo.link}`, '_blank');\n  }\n\n  openInNewTab = (url) => () => {\n    window.open(url, '_blank');\n  }\n\n  openMainMenu = () => {\n    const { goBackTo } = this.props;\n    window.location.hash = goBackTo || '#/msg';\n  }\n\n  _renderMessages() {\n    const {loading, messages, messagePending, loadingMore} = this.state;\n    if (loading) return <MessageList loading/>\n\n    let lastDirection = '';\n    const showTimeHeader = (msg) => {\n      const direction = getMessageDirection(msg);\n      if (lastDirection !== direction) {\n        lastDirection = direction;\n        return <Message.Footer sender={timeAgo.format(new Date(msg.created_time))} />\n      } else {\n        return null;\n      }\n    };\n\n    const showTextMsg = (msg) => <Message key={msg.id} model={{\n      message: msg.message,\n      sentTime: timeAgo.format(new Date(msg.created_time)),\n      sender: msg.from.name,\n      direction: getMessageDirection(msg),\n      position: 'single',\n    }}>\n      {showTimeHeader(msg)}\n    </Message>\n\n    const getImages = (msg) => (msg.attachments?.data || [])\n      .filter(a => !!a.image_data)\n      .map(a => a.image_data);\n\n    const showImages = (msg, images) => images.map((img, i) => (\n      <Message key={msg.id + i} type=\"image\" model={{\n        direction: getMessageDirection(msg),\n        type: 'custom',\n      }}>\n        {showTimeHeader(msg)}\n        <Message.CustomContent>\n          <img src={img.preview_url} alt=\"\" onClick={this.openInNewTab(img.url)} style={{width: '200px'}}></img>\n        </Message.CustomContent>\n      </Message>\n    ));\n\n    const showPendingMsg = () => <Message model={{\n      message: messagePending,\n      sender: Config.INBOX_TITLE,\n      direction: 'outgoing',\n      position: 'single',\n    }} className=\"pending\" />\n\n    return (\n      <MessageList loadingMore={loadingMore} onYReachStart={this.onYReachStart}>\n        {messages.map(msg => {\n          const images = getImages(msg);\n          if (images.length > 0) {\n            return <>\n              {showImages(msg, images)}\n            </>\n          } else {\n            return showTextMsg(msg);\n          }\n        })}\n        {messagePending && showPendingMsg()}\n        {!Config.INBOX_SEND_ABILITY && // add margin bottom\n          <Message style={{ marginBottom: '2em', opacity: '0' }} />\n        }\n      </MessageList>\n    );\n  }\n\n  handleSendMessage = async () => {\n    const { psid, input } = this.state;\n    const { markRead } = this.props;\n    const messagePending = input.trim();\n    this.setState({ messagePending, input: '' });\n    try {\n      const { message_id } = await makeRequestSendAPI('post', '/inbox/messages', {}, {\n        messaging_type: 'MESSAGE_TAG',\n        tag: 'HUMAN_AGENT',\n        recipient: { id: psid },\n        message: { text: messagePending },\n      });\n      markRead(psid);\n      this.setState({ messagePendingId: message_id });\n    } catch (e) {\n      this.setState({ messagePending: null, input: messagePending });\n      window.alert(JSON.stringify(e.response.data));\n    }\n  };\n  _renderInput() {\n    const { input, messagePending } = this.state;\n    return <MessageInput\n      as=\"MessageInput\"\n      value={input}\n      onChange={(txt) => this.setState({ input: txt })}\n      onSend={this.handleSendMessage}\n      disabled={!!messagePending}\n      sendDisabled={!!messagePending && input.length > 0}\n      sendOnReturnDisabled={true}\n      onAttachClick={window.openTemplateDialog}\n      placeholder=\"Type here...\"\n    />\n  }\n\n  render() {\n    const { loading, profile, psid } = this.state;\n    return (\n      <ChatContainer>\n        <Header\n          as=\"ConversationHeader\"\n          loading={loading}\n          profile={profile}\n          psid={psid}\n          openConversationOnFB={this.openConversationOnFB}\n          openMainMenu={this.openMainMenu}\n        />\n        {this._renderMessages()}\n        {Config.INBOX_SEND_ABILITY && this._renderInput()}\n      </ChatContainer>\n    );\n  }\n}\n\nexport default withMessengerContext(MessageView);","import React from 'react';\nimport Conversations from './Conversations';\nimport MessageView from './MessageView';\nimport Config from '../../Config';\nimport { HashRouter, Route, withRouter } from 'react-router-dom';\nimport \"@chatscope/chat-ui-kit-styles/dist/default/styles.min.css\";\nimport {\n  MainContainer,\n  Sidebar,\n  ChatContainer,\n} from \"@chatscope/chat-ui-kit-react\";\nimport { MessengerContextProvider } from './Context';\n\nclass Messenger extends React.Component {\n  state = { tid: null, viewHeight: '100vh' };\n\n  updateHeight = () => {\n    if (window.NUI_VIEW_HEIGHT && this.state.viewHeight !== window.NUI_VIEW_HEIGHT) {\n      this.setState({ viewHeight: window.NUI_VIEW_HEIGHT });\n    }\n  }\n\n  componentDidMount() {\n    this.intervalId = setInterval(this.updateHeight, 1000);\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.intervalId);\n  }\n\n  MessageView = () => {\n    const { tid, viewHeight } = this.state;\n    const { goBackTo } = this.props;\n    return <div style={{ position: \"relative\", height: viewHeight }} className={!tid ? 'home' : 'chat'}>\n      <MainContainer>\n        <Sidebar position=\"left\" scrollable={true}>\n          <Conversations tid={tid} />\n        </Sidebar>\n        {tid\n          ? <MessageView tid={tid} goBackTo={goBackTo} />\n          : <ChatContainer />\n        }\n      </MainContainer>\n      <Config.CustomMessengerWidget />\n    </div>;\n  }\n\n  MessageTidChanged = ({match}) => {\n    if (match.params.tid !== this.state.tid)\n      this.setState({ tid: match.params.tid });\n    return null;\n  }\n\n  MessageTidReset = () => {\n    if (this.state.tid !== null)\n      this.setState({ tid: null });\n    return null;\n  }\n\n  render() {\n    return (\n      <HashRouter>\n        <MessengerContextProvider>\n          <Route path=\"/msg\" component={this.MessageView} />\n          <Route exact path=\"/msg\" component={this.MessageTidReset} />\n          <Route exact path=\"/msg/:tid/:name\" component={this.MessageTidChanged} />\n        </MessengerContextProvider>\n      </HashRouter>\n    );\n  }\n}\n\nexport default withRouter(Messenger);","import Messenger from './Messenger';\n\nexport default Messenger;","import { makeStyles } from '@material-ui/core/styles';\n\nconst drawerWidth = 240;\n\nexport const useSidebarStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n  },\n  appBar: {\n    zIndex: theme.zIndex.drawer + 1,\n    transition: theme.transitions.create(['width', 'margin'], {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.leavingScreen,\n    }),\n  },\n  appBarShift: {\n    marginLeft: drawerWidth,\n    width: `calc(100% - ${drawerWidth}px) !important`,\n    transition: theme.transitions.create(['width', 'margin'], {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.enteringScreen,\n    }),\n  },\n  menuButton: {\n    marginRight: 36,\n  },\n  hide: {\n    display: 'none',\n  },\n  drawer: {\n    width: drawerWidth,\n    flexShrink: 0,\n    whiteSpace: 'nowrap',\n  },\n  drawerOpen: {\n    width: drawerWidth,\n    transition: theme.transitions.create('width', {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.enteringScreen,\n    }),\n  },\n  drawerClose: {\n    transition: theme.transitions.create('width', {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.leavingScreen,\n    }),\n    overflowX: 'hidden',\n    width: 0,\n    [theme.breakpoints.up('sm')]: {\n      width: theme.spacing(9) + 1,\n    },\n  },\n  toolbar: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'flex-end',\n    padding: theme.spacing(0, 1),\n    // necessary for content to be below app bar\n    ...theme.mixins.toolbar,\n  },\n  content: {\n    flexGrow: 1,\n  },\n}));","import React from 'react';\nimport {\n  Forum,\n  Receipt,\n  EventAvailable,\n  Help,\n  CheckCircle,\n  ExitToApp,\n  ListAlt,\n  Settings,\n} from '@material-ui/icons';\n\nexport const SidebarItems = [\n  { list: [\n    {\n      title: 'Inbox',\n      href: '#/msg',\n      icon: <Forum />,\n    },\n    {\n      title: 'Qun l',\n      href: '#/manage',\n      icon: <Receipt />,\n    },\n    {\n      title: 'Bi  ln lch',\n      href: '#/scheduled',\n      icon: <EventAvailable />,\n    },\n    {\n      title: 'Bi  ng',\n      href: '#/fbfeed',\n      icon: <ListAlt />,\n    }\n  ] },\n  { separator: true },\n  { list: [\n    {\n      title: 'Hng dn',\n      href: 'https://blog.ngxson.com/tonghopevent/',\n      icon: <Help />,\n    },\n    {\n      title: 'iu khon s dng',\n      href: 'https://sites.google.com/view/tonghopevent/',\n      icon: <CheckCircle />,\n    }\n  ] },\n  { separator: true },\n  { list: [\n    {\n      title: 'Ty chnh',\n      href: '#/settings',\n      icon: <Settings />,\n    },\n    {\n      title: 'ng xut',\n      href: '#/logout',\n      icon: <ExitToApp />,\n    }\n  ] },\n  { list: [\n    {\n      title: 'Tng hp cc d n v cuc thi',\n      href: '#/',\n      icon: null,\n    },\n    {\n      title: 'ng bi (Ly nh)',\n      href: '#/getimage',\n      icon: null,\n    },\n    {\n      title: 'ng bi',\n      href: '#/publish',\n      icon: null,\n    },\n    {\n      title: 'Xem bi vit',\n      href: '#/view',\n      icon: null,\n    }\n  ], hidden: true }\n];\n\nexport const getCurrentMenuItem = (currentHash) => {\n  for (const { list } of SidebarItems) {\n    if (!list) continue;\n    for (const item of list) {\n      if (currentHash.startsWith(item.href)) return item;\n    }\n  }\n  return null;\n}\n","import React from 'react';\nimport { useTheme } from '@material-ui/core/styles';\nimport { useSidebarStyles } from './styles';\nimport Drawer from '@material-ui/core/Drawer';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport List from '@material-ui/core/List';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Typography from '@material-ui/core/Typography';\nimport Divider from '@material-ui/core/Divider';\nimport IconButton from '@material-ui/core/IconButton';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport { getCurrentMenuItem, SidebarItems } from './SidebarItems';\nimport { withRouter } from 'react-router';\n\nfunction Sidebar({children, location: {pathname}}) {\n  const classes = useSidebarStyles();\n  const theme = useTheme();\n  const [open, setOpen] = React.useState(false);\n  const currentMenuItem = getCurrentMenuItem('#' + pathname);\n  const isPublicView = pathname.match(/\\/(view\\/|login)/);\n\n  const handleDrawerOpen = () => {\n    setOpen(true);\n  };\n\n  const handleDrawerClose = () => {\n    setOpen(false);\n  };\n\n  const handleClickItem = (item) => () => {\n    const { href } = item;\n    if (href.startsWith('http')) {\n      window.open(href, '_blank').focus(); // open in new tab\n    } else {\n      window.location.href = href;\n    }\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar\n        position=\"fixed\"\n        style={{ zIndex: open ? 80 : 100 }}\n        className={`${classes.appBar} ${open ? classes.appBarShift : ''}`}\n      >\n        <Toolbar>\n          {!isPublicView && <IconButton\n            color=\"inherit\"\n            aria-label=\"open drawer\"\n            onClick={handleDrawerOpen}\n            edge=\"start\"\n            className={`${classes.menuButton} ${open ? classes.hide : ''}`}\n          >\n            <MenuIcon />\n          </IconButton>}\n          <Typography variant=\"h6\" noWrap>\n            {currentMenuItem.title}\n          </Typography>\n        </Toolbar>\n      </AppBar>\n      <Drawer\n        style={{ zIndex: 90 }}\n        variant={isPublicView ? 'temporary' : 'permanent'}\n        className={`${classes.drawer} ${open ? classes.drawerOpen : classes.drawerClose}`}\n        classes={{\n          paper: open ? classes.drawerOpen : classes.drawerClose,\n        }}\n      >\n        <div className={classes.toolbar}>\n          <IconButton onClick={handleDrawerClose}>\n            {theme.direction === 'rtl' ? <ChevronRightIcon /> : <ChevronLeftIcon />}\n          </IconButton>\n        </div>\n        <Divider />\n        {SidebarItems.map((obj, i) => {\n          if (obj.list && !obj.hidden) {\n            return <List key={i}>\n              {obj.list.map((item, j) => (\n                <ListItem\n                  button\n                  selected={currentMenuItem.href === item.href}\n                  onClick={handleClickItem(item)} key={j}\n                >\n                  <ListItemIcon>{item.icon}</ListItemIcon>\n                  <ListItemText primary={item.title} />\n                </ListItem>\n              ))}\n            </List>\n          } else if (obj.separator) {\n            return <Divider key={i} />;\n          }\n          return null\n        })}\n      </Drawer>\n      <main className={classes.content}>\n        <div className={classes.toolbar} />\n        {children}\n      </main>\n    </div>\n  );\n}\n\nexport default withRouter(Sidebar);","import React, { useEffect, useRef } from 'react';\n\nconst updateViewportSize = (div) => {\n  if (!div) return;\n  window.NUI_VIEW_HEIGHT = div.clientHeight - 64;\n  window.NUI_VIEW_WIDTH = div.clientWidth;\n};\n\nconst Measure = () => {\n  const elem = useRef(null);\n\n  useEffect(() => {\n    if (elem && elem.current) {\n      setInterval(() => {\n        updateViewportSize(elem.current);\n      }, 1000);\n    }\n  }, [elem]);\n\n  return (\n    <div ref={elem} style={{\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      height: '100%',\n      width: '100%',\n      pointerEvents: 'none',\n      //border: '2px solid red',\n      zIndex: 1000,\n    }}></div>\n  );\n}\n\nexport default Measure;","import React from 'react';\nimport Theme from './Theme';\nimport LoginLayout from './layouts/Login';\nimport HomeLayout from './layouts/Home';\nimport ViewLayout from './layouts/View';\nimport PublishLayout from './layouts/Publish';\nimport GetImageLayout from './layouts/GetImage';\nimport './App.css';\nimport './bootstrap.css';\nimport { HashRouter, Route, Switch } from 'react-router-dom';\nimport MuiThemeProvider from '@material-ui/core/styles/MuiThemeProvider';\nimport Alert from './components/Alert';\nimport Scheduled from './layouts/fb/Scheduled';\nimport FBFeed from './layouts/fb/FBFeed';\nimport Settings from './layouts/Settings';\nimport Messenger from './components/messenger';\nimport Sidebar from './components/sidebar/Sidebar';\nimport Measure from './components/Measure';\nimport Config from './Config';\nimport Utils from './Utils';\n\nclass Main extends React.Component {\n  constructor() {\n    super()\n    this.state = {\n      header: 'Home',\n      publishData: Utils.getLocalStorage('publishData') || null,\n    }\n  }\n\n  changeHeader(header) {\n    if (this.state.header === header) return\n    else this.setState({header})\n  }\n\n  gotoPublish(data, publishAction) {\n    this.setState({publishData: data})\n    Utils.setLocalStorage('publishData', data)\n    window.location.hash = '#/' + publishAction\n  }\n\n  Home = () => {\n    return <HomeLayout\n      gotoPublish={this.gotoPublish.bind(this)}\n    />\n  }\n\n  View = ({match}) => {\n    return <ViewLayout\n      id={match.params.id}\n    />\n  }\n\n  Publish = () => {\n    return <PublishLayout\n      data={this.state.publishData}\n    />\n  }\n\n  GetImage = () => {\n    return <GetImageLayout\n      data={this.state.publishData}\n      gotoPublish={this.gotoPublish.bind(this)}\n    />\n  }\n\n  Copyright = () => {\n    return <center>\n      <br/><br/>\n      Developed by&nbsp;\n      <b><a href=\"https://ngxson.com\" target=\"_blank\" rel=\"noopener noreferrer\">Nui</a></b><br/>\n      Version {Config.VERSION}\n      <br/><br/>\n    </center>\n  }\n\n  Logout = () => {\n    Utils.removeLocalStorage('token')\n    window.location.href = '#/'\n    window.location.reload()\n    return null\n  }\n\n  render() {\n    window.changeHeader = this.changeHeader.bind(this)\n\n    return (\n      <>\n        <Route path=\"/manage\" component={this.Home} />\n        <Route path=\"/login\" component={LoginLayout} />\n        <Route path=\"/view/:id\" component={this.View} />\n        <Route path=\"/publish\" component={this.Publish} />\n        <Route path=\"/getimage\" component={this.GetImage} />\n        <Route path=\"/scheduled\" component={Scheduled} />\n        <Route path=\"/fbfeed\" component={FBFeed} />\n        <Route path=\"/settings\" component={Settings} />\n        <Route path=\"/logout\" component={this.Logout} />\n        <this.Copyright />\n      </>\n    );\n  }\n}\n\nconst RedirectToHome = () => {\n  window.location.href = Utils.getLocalStorage('token')\n    ? '#/msg'\n    : '#/login'\n  return null\n}\n\nfunction App() {\n  return (\n    <HashRouter>\n      <MuiThemeProvider theme={Theme}>\n        <Sidebar>\n          <div className=\"mainView\">\n            <Switch>\n              <Route exact path=\"/\" component={RedirectToHome} />\n              <Route path=\"/msg\" component={Messenger} />\n              <Route component={Main} />\n            </Switch>\n          </div>\n          <Alert />\n        </Sidebar>\n        <Measure />\n      </MuiThemeProvider>\n    </HashRouter>\n  );\n}\n\nexport default App;"],"sourceRoot":""}